package httpserver

import (
	"crypto/ecdsa"
	"crypto/elliptic"
	"encoding/base64"
	"encoding/json"
	"fmt"
	"log"
	"math/big"
	"net/url"
	"strings"
	"testing"
	"vc/pkg/openid4vp"
)

var walletResponse1BodyMedJWE string = "cmVzcG9uc2U9ZXlKaGJHY2lPaUpGUTBSSUxVVlRJaXdpWlc1aklqb2lRVEkxTmtkRFRTSXNJbXRwWkNJNklqRmlZVFkwTWpsaExUTTROR010TkRJNU1TMDVaakJoTFRWbU1tTTBPV1UwTmpZNE15SXNJbVZ3YXlJNmV5SjRJam9pV2kxdmVrTnZWSGRuVkdkTU4yOXNielUxTFRjNVJYRmllbG8xVVVWR05sRnBYMEZmZVRSemNYbGFTU0lzSW1OeWRpSTZJbEF0TWpVMklpd2lhM1I1SWpvaVJVTWlMQ0o1SWpvaVpUVTJVREpuUVZrNFVFSkdkR04yTkcxSmFqaFVhWE5LUW5OR2F6VnJiMlJNZEdndGRGWlZVRzg0VFNKOWZRLi5VNVQ4Z2xtdWN1bElBZUFKLm5XVWVPM1JqMlNzNFJxdll0b0dKZkNIOFRWTkZ4bVQ5RWw4ZHAwSEpieDNJeXI0MHlNNjdwaGU5NmFRSUVGVC1kdUJjb0NaZkZYUHd4QjBVR2xPeUsyZGdEQkh4SGNyUDhvQm1yZk1LQXVlTWJqak9UZ29KR2Rib1Fod3VxaFp3Yy1iSnFNNU53QzZwcG5EQS1uYy03VkdRLWFrakxxU1ZVajl2c29ZbzdSMWZUclR5Rzc1cmNvRlljUUh3bXQwcVVhMkNabzVPY2V0M1FMTVJWWVdKNFNuWTUwcXNGUnVhd2tSZVRiVmt6N2xVcEhjdEEzeWE5N1dsU0p5ZXl0VXBReVVid3VQUUtSbG10N0N1eHNXN1VoOWxvb0tzSk0tZ28tVDkyQ01KUG9ybFpNM2tEdTRCUVpTMWZ2MjVhMGhaaGNCY3lDeVBQVkNyaXpvYlpYeEk2ZzBicEE3TGJrZHNncTFaNzlYWXBTdG5wN01ZQ1pwazNkMkNSVWE1QUM3OVFBZGxIZ0wxN1BrMlh4TlBUdHpsVFBBdThLTG5pR2V4cXBNenJiczJhcWRHdkRwWEo0UXZ3NzhvLXljMVZjQWxPZmV0WVpSN1NLMDNVeXVIVmlWQ2oxczlUdzl6OVg1blIwNWtVci13cmpTZm9DOWRnOUpqd25VV1d5MHVKTDNhamVfaWFzSjZxVElQVm50bWI2NzN2dGxiU3NSVGh2eTNJSWFhTkFaZHNiSlR0NXdsV0JNdkZUZERKS2twemhoTjB4cHJhX0VpdkpyZDZtYUh6aXdOU0pBZW9oVDJaTWhCWHJCU0VjUnR5UDdPM2xPdTdOeHpsSkdHc0dlTTBadlQyR0VWU3FCekJ3NU4xbmprc3FVVjd6clBzUTJLS3AzZFlvdkRqTTJ6Zmk4NVVFNV8wUE5odjFVMmpESUc5dU1GVmpLRGxHSzUtd2lXcDVBTXhlUzBXWG1EYlROMEFNLW5UTk52ZmVjUDRFcEpqU18zeVNtbDlFeUg1M1M5czFpbWhhaVhGSFY4ZTBUVlJkTklwLXZkd0owOFV2d045UkZaVk9mUTVZckdIaGgzMVhvVThDemlrcXQ1ZXZzaFkwMnJmMWNsdGtpbFJnSUY4dzhzVm1YRkRxWm1HY3NMMXBQY3ZNRVZRQy1CWUVaWk0wTko0RHE4bGpfTEluNlpQV2JKUFc1T3MydEFUbm8yQWJPNTlOWUdGYVd2ay1Yc1lWZFRCUERmNWNKeDQyTXhna3MtbHVRZWgyTGJiMnZRWUIydGszQVNiOURkVXdHYUZ3Snh2d2t6dklJWVpDRzRnQ2xtWWI1M0NtT052dDhkNjlOS0YzMl92MWNZNGptVWlZdEQ2Y1B3N0hHNHRqdDNaUjIybjN0bW9MSDBBS2hmRHZSdk9PS3NCaWl3bi1wekhRU05aLVgzQkhuLUROZjJ5WkpGTUlscERNeUxjaTY2M2JUcGdXZGsxV0JKSzRia2FwWFRCQmZXS1pPMGlId0x4LURram1TZ1JGcVlUQWd5Z2pZVFFITDh2aWtFYkMtUm5IeXc4Z1llVVI0MkpxdWthcXI3NmVzMmxhbVljdjkzQV9TM1RQVVh0UFZHczNQalozVEQ4T1VXSndubTVIak05N3Q3WU9ZQ0xiY2FLWnZjU3lXSzlSZ1lDTGUxMWRsUVU5ZE9GcHZidDdnQzUtSEc5UlZDY091ekMtQXVZWWV6QkZKVkdFOVhmWXllVUhhNkJLRm94NmFyMzgtR2UzWGM1cmJxZG1NYWNUWjRPNWUtdHdGWmRSNUtpb1BhMWc5dzROTW1yWDdXYm54dGhqc093SENwT3JGQTkwVkdMc2hhaHJ3Y3FrLTV1UVJZYjRtYk1mLTZOdlJvbHpHVEQ1cUZmTWJDRTZTTWhxQjM4M1V5U05JanJPTTdsVjBIakJzQ2hEOGhfdldBeU55Y0x6Tml0WHdLMnlXUTNnNjhKaGVBV3cxODFzb2s4YnBsbXhxVV9DRHM1bUEwRjJoOWtwck5wSnFuZWR2S0xaNEJXU1Q0M3QtWWVFS1dNV3JlODNWWVJobHFiOGFheFh1OHhseVNUOUZEUXp0ZDA3SGNxVkVKYklBdEhCYjRGTkJmX3NhTXR3dnRjNjUtLXVUT3EzSm9CN1NWMlJJU1l1NlNGdThvUXQ2aHl6YlJXbjFPdFhsZ25fdHJ6dU5qR2dwdjdsVkFZdThKQWhUSTBpTmpZekV5bXFCVlN5ZDE5RS1uR3lqNUtUclJEcG4wNnE1Mk9LMHJVRzd1ZFVtMndzLS1KNmFMcXlDZWJIQ09XWlQ3Q2JNYkJvY052TXl4ekRqLUJiUWRjQ1Uzbmo1UEdlNkVKNzVvREwyT0xMTlg3Tks1MndiN2JESzA5OE1aM1VsdVZ1TkpOX3I1YXN4eXZ6VDkxbWwzOWo2NzZqZmtFUGdhOXZmUHNyWDZRb3YwdWxmeVJnOW1CcF84US1JYUFjamRUSE1EV3hDeEdvcDVNX1pyejF5YjFTMDRHbnNpcW51RVgwM0dibzkwOWJJYVQzWkpSUmZUZVFURVc5V2hScC1jTGVEQVJlN05TVEVYQUR3MnlXX3VZOGMyNXViUE1EdXI2cTU2S3FHZEN3SnE0YUpNY3o4dGc4S1B1NG84UEx0MktUdVhmTHBBQm9DVVEyOUdMQW5tUHRCMGJyRTJ6S3VyanFMM1h6RGxBelg0eHE2SV9CODhKV3VJNlU4ZE5mcFdrZ2lwVm5UeHFNb2Y3QkZlUVhxcl9pOTJnSFNicWtNNm5WUnFDT3hCdmJVOEdRZDhsVUxWZmx0d1ZtODRxeTZmVGJVTF96a2Z4V3NsTHhvc21XcDJ0M0F3dzRqaS1QSHRnWUVYekFhcUtRYnNlQnAtSUp2TWdmM1NLemVKZEY2c1JJbE9ybHZ4c2hvaGRrWXROQjVseEVvTnc0YkQ1NDJvejJJNDVwcUdPb3J2WEJHTkdPZ1NCclJuZUlwbTZEd3kwVk43Nm5DcnZLcWI3bzlfUzRJUkRmbURVY3hfZi1hWXNyQXQ4Tnp4ZGhzdS1XbnZWTmpmSFIzQnBvQzVBNUtma1I5cTk1Z1gwWGNxcmd4V1Q4QklBRWE5blhDUE5Nc2ZvLW95a2ZZV2RVR2dNXy1SeXpPUl82M1lzWjVON1FqNkZzZGd4eWpUY1U2NHhvTkxsVXBvNTRFdDJhR1Z6Y1RhaWU4T2dIcUR4ZU9XenpZcDZBN1JveVZsOWEyOWxJTlJfcDZhdGtYaVp0bDEtbmN4dWFNUXQtWkVIdGwyNzF6b09tcHpQUk1CM1JnLXc3WWwteXIxYXJmLVhhSXpOZFo0Ny11YnEwelZRcTQ2dXBZRDJTaVZRWDNleVlhdGh1bFZtN1E2d0pxTHZvY3F1Y1NEdkI2V2dnVnN1ejV5NTdDNXlSOVVlak5iclJIdl9IcWVpN0xvdFFoa1VabjlPZEtqbzNoakpjRTJjVW0zQ3RObHNWRGhZbFZqdUpVTlhQeFdBekxrdUZybEIzbGpXWmo3RWpfamNvVEx3ZTM4Ykt2aHNzbFdJLVcwUTNhNXpRNmJBZzEydVBuRGdNbndyLVJsZVJOaUVMOWE3bHh3clV4UVdWLTI4aEVxcS1IanZWX1pQcEFCUEk5WWlQRVNpWU5VSHl2WEloamxVSDV5bk90dV9XdWZCN1VFX1JvWi1qQ3ZlN3FTSHBXUmFwNk1tVjFqVnJRZ21DeWhLTUROYjIwSEswQ0Q1WkY4eG9UY3RaeEJlNlVSaFh4MWZCRkN6MGZINnVNdHJMUzUzbVlTOENyZXMtREE5czI1OTdNODB4YnJqZDJMZ0FrbDNHQTI0UGNmdmJoQk9peVU2WUJ0X1BkMU9PX0h6bWc1N1djUTBxZmR5NWxuUV9lcWJoRVNNSC1tQ1BPSE5zdzJSbmNZc1lPckRDMjgwSGdLeFVTcWFBV3EwNDZ2bXZzbEtjUTJCekZvaFRHRzRXV01SNEkySGxoeUJWRE93b1VzX2dyTWtWc3J1U3MzQnJjVDhDa2tEWTgycnlKQlU0NnpVdTJfS0ZrMFlUbUJpalFyNHhBQ3lWZXV4NDJUazNqSDk4d1d5ajN6cnIxbVNYMloxVW1CQnhpREV5OFI5aUlRUU1mOFNucWtfOTBsVXg1UXotN0ZGTTFmNDFhUGRoeS1oaW5TRjcta3hIVmpRU2RnbUdBbTh0STdGQTlNcm03YmYtRXBCOE45V0dRX0xPQnBSS2pHbEptZGZFSjBpNllFYWlJN2x1VGlDdThLVlN3dmswY0JiV2ZKUkIteXBLZ2FvdGFVYUx2QmhETWpSQW1zMU52cTVfUHRzdDJqenVibFdocks0R1NWTy0yOGJKaDM4QnNfMUd2ek5Ydlh2Wlh5aFNMeElHRXFPUlFEcnZaXzhxZkNoeFBnTEpJZHdlVU9QRU44NGdjLUY2VGkzUUN2TWxGYUhyb2RETVlDXzNjRE52SG42em5XeHdrOWhTSklrZGlkOWtBU05aVGtlOG9haHhIMHRSTXNBTmFvZnZSQTNiNVhlUHJOVVZ3QzM0MEtZX3VQVjJxQVJJVGN0eTFNQjZnTzJSelBlaEEtM0gzOU9TNDNudjdLSmxWbk03NmJxWXF2bVQ2dElxRGplWndMdllIR1dnTUdGaGVDYW1KcHVCVVE1RXBKbFdfNnRlVURBaEd3N29BSzhueDBOVERJbUdTNUNVbkwtTnZJRFk5ZFNuc3R5M19TbnNJeUNQMVlmdWs4MV9zM1B3TFZhSHZZQWtBTjZoS0tndGhsMTJ5bGRWcWJZLV9yZ1VUbHNDNC1EUTEzd0xDQmNTUUU5YjQtSGM4Q1dETWYtaUY4bFkzb2ZRVFZDVk0tanFQYWU5aFNJdFl6bzV6cXRxVFUyLVQ4Vm1qYjFkSWtCWFAwS3RWRXN3OUI1d0doTXMtcWd4NWhWQmJrZnRCY3lDd1lmNWg4T0hwSG1UQ0p6MFdyNUNjdFUyc2ZOTGFSTV93N0Z0Tm1jYWdIMjlMR3NkanRUOF9wLWR5N01YdFFVdTNHTjZiU2JyWmcwZkduVHpzbVZzVG44Ulc4SmlHd3lvdUJ1ZEtKbzFrX0tkdjhpTkNHc05FaVp5dFlEMkp5Y2JNdENCM3hURUpBbDVzZU9TY1htRWxQUHlCRkljbkd2ZUdWclVRZVZ3Q1VlTmQ0MDF2eFNvWmdUbzM5YzN0U2s1eV92eEg1ZXRPT2w1STRxdE02emhSV213aXlYYUVEY19wR2RNcnUyRTYtdXU5Tk5pV3J1dndtNTlXQ0pkdVdYWjA2bXA2RXRnTE53NjNhemZxQnkxajBJRXlQTTU3ZmlSaVJSdmJXSGVvVkFSYW95OEx2WW51dm1tb2dsZHliNDNlZmN1Z2M0UVZFamVRQnMxdjBVZGxUVldlZ2lSTWdHaC1RSkktcDNWa3h6YUU1WGQ1aHZrQ01IQnBsNEUybzVyWnVqSzdUWnJMVXRnaG1oN2tZMjNGVlNSZHE4OGJKQ3VONGtISnpaYmN6eTZlTGFTeDZHbld2b2RQdDhGZzZLRjBrb1NBWGxYeDh0LXMxdENSNl9Eckp3SV84cUNWdG15Uk5qMHc5V1NpNFc0LVVua1ZmOFMtYVZ2S1N4U3FWMFc3YkpSbmxsWjNaR09xSkdGMTJtWGpZSFpIcnFXN1A5cXpuSU5YXzN6NHVPbmNBTkRWZjNhTDVOd0tZUjhUNk1ranFjX0JFdVlmck5veV9iOVJJT3pva1BUNmpZcVNrbm5lcFN3N2RWcHZvRm5jdzZ1bkFCcDFhOTVKemdpQ3YtZnM2ekM4R1ZXdzlFdnV0RmY5NWZkdWJXb0dmTDRrVy1RWFFkT0pqNEhYT3JJWldKdnYzUC1JZk5rNFFrRHktTGkyRTZidFJ4OENEa203X0gyRW5EellCSFNOb0xBWVZtcjJUbVRIUFJ4N213Z05tZmhUVk5JUDRZMDAtV2RoUkxKYzVSaDNDNjVqemducDVGLU0zWnV6d2cwM1VmMjBSOU1GZ19VOTN5ZWRqeG1aUlFwSkw1TzFMQkpIZ2h1U000clhpajFFMzJkN19TZHVKV1puWUtubFJXa1dYR214d01ZdHdiLTdsM19rWjNRYXFOaWZwUmhjYk55UHBoREt2NFM3Ny1zVm1lVWt3WmdxZXpJZmhzWEkxYW9IMVhIbnZNUE00TDlTSjNEMy1uWmNwS2JGeVl1aWxjc3k4Z3JWbjJNM1ZfRnpXckxrTDBqNW5XUUFoemhqZlR3Z0N2ZzlRU2RwUThfWUJSejlqdGh4bWNrcHFZc1p5bWk3Q2QybWs5c3lXbnpQTWZDRFVBUEZOMXFjZ2F3Zkp5X2ZheVF3WHhwemtuTG40N3BpaV9IVUllSU44TGx4c2ZEdHctb25jTVhLQXlDN1VoZV80TWs2ak1KS2Fhbzh4RE5fT0RrdWN1SDlxQTNrYXFKemc2dnFmcFVyc0lrQllVUDU4bko4MFhzWWJwN2M3a1Y2YUxBWXVoMnZRcDFwTnlfdGxzX29jQTBPMUNHaTZoOFhsRkxOQjBYUDNRcEhjZmZXbW9hRnpISC1vRHdzMk9hUFVaUHU5dUNPM0lQV1VSQktTbFdlbnBZaDBTV2stZERFeGE5emVtTVNsYVhHQWZ3cnlsWkJTUWNwdS1xRGdsM292aTgyMGdteTdzaGdnMEs5Ty16c1hEMkhFeFBRTVp2cmZQNW44UjFJaGdvUXVEclI1d3hjazcxd0FxSFhIeHI4Nk9ZdFdmek9seVFEOHVyRGdmdlpKUDVyS2laeHJnOFhKbDNQOWNYVVpxS0h6QVVscTN3RWROdmJFdHZBa1ZxQzVUWHpNUFlqY2JxQ2pfREJ1MDVXZWR2VnJrYjh3SVg3VVQxMExhbUFxZFpGZnQtYmR6c2NDX0VFaU5zQnF5eW9qZzdRY1FWU210Unhtd3BsUTJLajRUeFpEaHRxM2xUR2RENXNwWTFwdmRoZDZxVlR4YS1lZGVJWjJkU2VHMHF4NXh2VGZFVE13UkpjYUdmcm5ULWowdGF0Q2s4OFpDbDdSd0hIQTU0YUpkQ0dKaHZITGFmTDlxYWEtN1Y0YjU2aGQ2Y0VXSXQxb2NxX2hlTFBZZ0FoeGNRdHcwNFZjSU1rUWJ4U05hUjRYai1YdDBQUlo1SEtvWTg5VkV0U0doQy1NbkRzaW9uc2Vyc2VPYmlySl9QMFF3bTdIRnpUd0NheHAzTmU5VXd6R2NTMERlZlItU1ItVmtGc3R1SXhlWmdseGdUdVhwWHpnTkNIT0RlT0p1dFQybENnZ1h3aThuRHRmUXV2VFhoVnp2RHhDdjlOakplZkoydURLV0pueEpyRmZoWC1QTEp2b1dzci1vdzJsZUlQUUFsS000bEdpZWZDODAxQnVsQVBJQjFhYzlFSEJJazl3X3JEcjZTMkpWcjNIT3cyT2YzcG9IZ015TUM1dWpKUEFIb25Pb0xWZlJjQzhtVzZDc3NaaW9IYncxX09IeVpaclB5bE9oc0k4NVNCdWpod1p2eHlqWHlpaV9kTnhDM3kySGNZRHhKaFozOHdsNkFFTW83aFR2RGJ0Q0dxcGt3R18xUXNoaHRTUFJEYlFWWE80c08xenVQellLa1cwZ09DdXQ5M3VaUmR2YWRNWUpwOXJEZEdiZG5jUG1vamlTQW9oUENQekpRZkxpTEw3MHRxQ3J1ekhBNzZhRm11ekRJaEhNRjRVOVAwSnNrOEZKTmd5NDJUc1N6TGh4LWJ1cXkwVi0zMlY5Q1JiaU5PYmZ4Vm1SMUUxZ0hHN2w3Vk8yV1FwaTNSeWlVQjFiWTctcVYzODA4a3ZQN2RyNmxiNFNtZHlnNFp4cl9pRU8xOUVkQkNnZ3lSY1AtWUlNdXJrb2Z4bEppVWRUbTdIUGNxVVlWaUNBa19HZE5iZEhJdUkzTzNJSm9iSU5EZ0RwNFpSUVlkVlJYVXI2NnVsTEVQS3N3WTJjbUtUR204YWV2T0VaQ2tBbWFMTmh1Rnc2bjJ2Y21lTW1HNWdSVG0tcDFHRWg0X1BKSVlzZE1fMVdrNlF0alBwUC1UeDRfa1pfYWxQMEJHTzBEbmJSV2VEeW4tVy1XTng3c2xaeGw0LWRRaThUMUJQQUpySmZabF9lWU9aenV0LTFaQjRnS1hYWUxGNXFsNnB3ZGREbFk0ZDFEaGpzNzlGREp2WjhEa255MVlLQlhPV3ppV0FDNzduWmZaYTBOWFhLbUd2aEg5ZVJQVDdidld6ZXBRc29felM3WVhFNnB1Q3ZSdW9iYXdENk1mUEdwWXhOQmRfVjhJVlRwQlUwWXVTWmV3aE4xWk1ES1dnZ3JGNHRsbGNXLU5PTDR5LThZd3Y0dHRBZEFEUWZUX1FsX05MVHZSZmxwc1BpN1JNV3ZlMDRoNUJqQ0ttYV90dk00dzZoRFBqa3gwVHlpeUpEbWRLZHdCUy1BZ21uUE4xMDVab1pjZGZMMG0wSkxKNDM1SDRPa1JsNkNmTlItc2ZMbzBTUk1CMkg1V1E4Vk1RZkdHdjRrTFo5clhzaHJ5em9JWnNJdE5Ucm1nYlVBRzNVOUZfT0txdDI3UkJiYi1rTVRXSzZvOWU1ald5cExBRkozYmloNmFmUW1TQUluTDNxeDdtcDNTWkk4N3NvNnRNbDY3UEtVNXk3cTBpYWF2VXV1NkkyY2ItTExNZkJ6aVdOZ29XRXZxTjVPRU9Ra0JiU01lWWVqTXdhWUswMmk1N3g2bmFBNzYtVUdRNWdfN2k0YU50NmpsRHllaHN0eXhwZFpLSzQzOUpYWWtjODIySVBEZFVTNGVKMUd0ZDJxa2lSaEdPWFZ0LXAtNXk0a245cGl5bVVTbVZVc2Y0MUZ1aGZuQTZxNjdfNkpXZml5cXktcENLNDNwNWxTcnF4M21jUVhNcjRQYi1Na0tGc2QxY3pXYmdXV1ZmU3B1Sm85d0M2ZExaY3oyWV8xTUpzWHFBSmpYb3V4TlNTRzFrN2RuMWlkOWlaM1lDNERWZEFkN2xwV1NlY2IxX2txcVN3OXBHSU80QUxoVFZCaEVKQ2pPT2Nmd3lhckprYzYxdzVkemM2cnZPck54TE54Zm9hWUhVcnZzXzVtYjdoeTdmMmFnTExDclVQSW52eWQ2RE1GY0FLb0NsUVplNjdKQUpZLThlOVdaRDRGTEhoV1MybXRrVGtJbGxUenpRNEgwZjNZZVU0MkR1dnRsV21COEhDcEppRTBiZUxlMWNlYldSVzZBMjlZWGIzb1RYZUdqbXFqU0ZTcHN4bDQwVW5ORnliZFc0bE5PMm5IX3VnZWNOcWJWWkFCRzZUSFo4RUtZMEV4dUxDd0c2ODVyRW5DWUZIQzFkODQxY040T1Y3Yjk3a2xiNUJjSUlaTXhYbEM4c201RENRTkpVc2ZMTjF6ZDVyT281VlFPZi1NZlRkVXBQRGdXRHREZWhCcUxSWkxpdXBmU0JTWTk3NjlUWWRlV0Q0RlZLaGk5MzNGUWtNcUY1LmNES0lJMmJ5U0dLMFZsOXFjZ0t4MGc="

var walletResponseBody2SomNogInteIsJWE = "dnBfdG9rZW49ZXlKaGJHY2lPaUpGVXpJMU5pSXNJbXRwWkNJNkltUmxabUYxYkhSZmMybG5ibWx1WjE5clpYbGZhV1FpTENKMGVYQWlPaUoyWXl0elpDMXFkM1FpTENKMlkzUnRJanBiSW1WNVNqSlpNMUZwVDJsS1JsTkZiRVJSTTBwc1drZFdkV1JIYkdoaVEwbHpTVzAxYUdKWFZXbFBhVXBHVTBWc1JFbHBkMmxhUjFaNldUTktjR05JVW5CaU1qUnBUMmxLVldGSGJIcEpSMng2U1VkR2RVbEZWa2xUVlUxbldrYzVhbVJYTVd4aWJsRm5ZVmhPZW1SWFZtdEpSMG8xU1VoU2IxcFRRak5hVjNoelNVZDBkV0l6WkhWSlJWWkpVMVZOWjFOWVRucGtWMVo1U1dsM2FWcEhiSHBqUjNob1pWTkpObGN6YzJsaVIwWjFXbmxKTmtsdFZuVk1WbFpVU1dsM2FXSnRSblJhVTBrMlNXdFdTVk5WVFdsTVEwcDVXbGMxYTFwWVNuQmliV05wVDI1emFXTXliSFJqUjNoc1NXcHdOMGx0ZUhaYU1qaHBUMjV6YVdSWVNuQkphbTlwWVVoU01HTklUVFpNZVRsNVdWaGpkVm95YkRCaFNGWnBaRmhPYkdOdFRuWmlibEpzWW01UmRWa3lPWFJNTWxKcVRrZFdNVXd6V21wTWVtczBUWHBLYVZscVVUVk9SMVpxV2tSck5FMXRUWHBaVjBVeFRtMVdhMDFYU1RGTlJGSnNUVEpGTkU5RVVtdE9SRnByVFdwTmRtRlhNV2hhTWxaNlRESldiMkZYVG1wWldFcHJURzVDZFZwNVNYTkpibFo1WVZOT2NHSnVVbXhhTTBwd1pFaHJhVTlwU25waFIwVjVUbFJaZEUxVVNUQlplbFp0V2xkRmVFNUVhR3RPVkZreFRXcGthVmxYUlROT2Vra3hUMVJyTUUxdFNUSmFWMVV4VFVSVmQxcFVXWHBPVjA1cVQwUmFhazFxV1RSYWJWRXdUV3BWTkU0eVVYZE5ha3BvVG1wc2FrNTVTWE5KYlVaelpFWTVNRnBZYURCSmFtOXBVbFZvU2xGNVFrUlpXRXByU1c0d2MwbHRTbWhaTW5SdVkyMDVNV0p0VW1aWk1qbHpZak5KYVU5cFNXcE5WRWw0VFVSa2FrbHBkMmxrUjFZMFpFWTVhbUl5ZUhaamFVazJTV2xPUjFKcldrZFNhMWxwWmxOM2FXTXpXbTVZTTFKc1lsaENjMWxZVW14amVVazJWek56YVdSWVNuQkphbTlwWVVoU01HTklUVFpNZVRsNVdWaGpkVm95YkRCaFNGWnBaRmhPYkdOdFRuWmlibEpzWW01UmRWa3lPWFJNTWxKcVRrZFdNVXd6V21wTWVtczBUWHBLYVZscVVUVk9SMVpxV2tSck5FMXRUWHBaVjBVeFRtMVdhMDFYU1RGTlJGSnNUVEpGTkU5RVVtdE9SRnByVFdwTmRtRlhNV2hhTWxaNlRESldiMkZYVGxWYVZ6RjNZa2RHTUZwVE5YcGtiV05wVEVOS01XTnRhMnBoVnpVd1dsZGtlV0ZZVWpWSmFtOXBZekpvYUUxcVZUSk1WMDAxVFVSbk5Wa3lTWGxaZW1ocFQwUlJNVmxVV1RWUFZHTTBXVEpOTlZsWFVtcE5iVkV4VFRKTk5FOUVTWGRPTWxaclRsZEZNVTlFV1hwUFZHeHBUMWRHYkZwSFZUUmFWRVpvVDFST2FscEVUWGRPVjBWcFRFTktkMk50T1hkYVdFb3dZVmRXZWtscWNEZEpiVGw1WVZkV2RXUkhSakJoVnpsMVNXcHZhVWxwZDJsWk1qbHpZak5LWm1NeVRtOWFWekZzU1dwdmFVbHBkMmxaTWpsMVpFaEthR016VVdsUGFVbHBabGd4WkdaWU1XUk1RMHBxWWtkR2NHSllUV2xQYkhRM1NXNUNhR1JIWjJsUGJITnBZekk1YW1GWFJuTllNMDVzV1ROV2VXRllValZZTTBKd1ltbEtaRXhEU210aFdFNTNZa2RHTlVscWNHSmxlVXB6V1ZjMWJrbHFiMmxhVnpSMFZsWk5hVXhEU25OWlYwcHNZa05KTmtsc1RuWlpNbXhvWWtOQ1ZGcFhUakZqYld3d1pWTkNUMlJYTVdsYVdFbHBURU5LYTFwWVRtcGpiV3gzWkVkc2RtSnBTVFpKYkZKdldsTkNlbUl5VG5CWlYzZG5ZekpXYW1SWVNuQmtTR3RuWW01V2RGbHRWbmxKUnpsdFNVaFNiMXBUUWtaVFJXeEVTVWRvZG1KSFVteGphVW81V0ZOM2FXTXlVV2xQYVVscFRFTktlbVJ0WkdaaFYxRnBUMmxLZW1JeVRuQlpWM2htWXpKV2FtUllTbkJrU0d4bVkwZHNkVWx1TUhObGVVcDNXVmhTYjBscWNHSkpiVTUyWWxoQ2JHUkhWblZrUmpsd1ltNU9NR0ZZVWpGa1IyeDJZbWxKYzBsdGJIVmpNMUp3WkVoV01HRlhPWFZZTWs1MlpGYzFNR051YTJsWVUzZHBXa2RzZW1OSGVHaGxVMGsyVnpOemFXSkhSblZhZVVrMlNXMVdkVXhXVmxSSmFYZHBZa2RHYVZwWGQybFBhVXBLWXpOT01WcFlTV2RSTWpreFltNVNlV1ZUU1hOSmJWSnNZekpPZVdGWVFqQmhWemwxU1dwdmFWWkhhR3hKUjJ4Nll6TldiR05wUW1waU0xWjFaRWhLTlVsSE9XMUpTRkp2V2xOQ1JsTkZiRVJKUjJoMllrZFNiR05wU2psWVUzZHBZekpSYVU5cFNXbE1RMHA2Wkcxa1ptRlhVV2xQYVVwd1l6Tk9NVnBZU21aWk1qa3hZbTVTZVdWVFNqbE1TSE5wWTBkR01HRkRTVFpYZVVwcVlqSXhkMXBZVW14aWJsSm1ZVmMxZW1SSGJEQmtXRkp3WWpJMGFVeERTbkJpYms0d1lWaFNNV1JIYkhaaWJEbHdXa05LWkV4RFNtdGhXRTUzWWtkR05VbHFjR0psZVVweldWYzFia2xxYjJsYVZ6UjBWbFpOYVV4RFNuTlpWMHBzWWtOSk5rbHJiSHBqTTFac1kybENTbUp1VGpCaFdGSXhaRWRzZG1KcFFrUmlNbEpzU1dsM2FWcEhWbnBaTTBwd1kwaFNjR0l5TkdsUGFVcFZZVWRWWjJGWVRucGtWMVo1U1Vkc2RXTXpVbkJrU0ZZd1lWYzVkVWxIVG5aYVIxVm5ZakpaWjJSSGFHeEpSVlpKVTFWTloyRkhPWE5hUjFaNVNXNHhaRXhEU25wYVEwazJTV2xKYzBsdVRqSmFNVGx3V2tOSk5rbHRiSHBqTTFac1kydzVjR0p1VGpCaFdGSXhaRWRzZG1Kc09XcGlNbEpzU1c0d2MyVjVTbmRaV0ZKdlNXcHdZa2x0VW5aWk0xWjBXbGMxTUZneWJHdEpiREJ6U1cxU2NHTXpRbk5aV0d0cFQyeDBOMGx0ZUdoaWJXTnBUMmxLYkdKcE1WWlZlVWx6U1cxNGFGbHRWbk5KYW05cFUxZFNiR0p1VW5CYWJXeHFXVmhTY0dJeU5HZFpNa1o1V2tOQ2RXUlhNV2xhV0VscFRFTkthMXBZVG1wamJXeDNaRWRzZG1KcFNUWkpiRkp2V2xOQ1NscEhWblZrUjJ4dFlWZE9hR1JIYkhaaWFVSnFXVmhLYTBsSE5URmlWMHBzWTJsQ2RscHBRakJoUjFWblVsVm9TbEY1UW05aU1uaHJXbGhKYVdaV01ITkpiazVyU1dwdmFVbHBkMmxqTTFwdVdESnNhMGxxYjJsaFYxSnNZbTVTY0ZwdGJHcFpXRkp3WWpJMVptSnVWblJaYlZaNVdESk9hR050VVdsbVUzZzNTVzVDYUdSSFoybFBiSE5wWTBkV2VXRlhPV3RZTWxaMVpFZHNNR0pIVm5SYVZ6VXdTV2wzYVZwWE5XdGhWelZ1V0RKU2FHUkhWV2xZVTNkcFdrZHNlbU5IZUdobFUwazJWek56YVdKSFJuVmFlVWsyU1cxV2RVeFdWbFJKYVhkcFlrZEdhVnBYZDJsUGFVcEdaVWhDY0dOdWEyZFNSMFl3V2xOSmMwbHRVbXhqTWs1NVlWaENNR0ZYT1hWSmFtOXBWa2RvYkVsSFVtaGtSMVZuV1ZjMWEwbElVbkJpVjFWbldsaG9kMkZZU214YVEwSXdZVWRzZWtsSFRubGFWMUpzWW01U2NGbFhkMmxtVmpCelNXNU9hMGxxYjJsSmFYZHBZek5hYmxneWJHdEphbTlwV2xob2QyRllTalZZTWxKb1pFZFZhV1pXTUhOSmJrNXFZVWRXZEZsV09URmpiWGRwVDJsSmFVeERTbnBaTW1oc1lsZEdabVJZU25OSk1teDFaRWRXYm1OdGJEQmxVMGsyU1dsSmMwbHRWalJrUjFaMVdraE5hVTlwU1dsTVEwcHNaVWhTYkdKdFVucEpNbXgxWkVkV2JtTnRiREJsVTBrMlNXbEtPU0pkZlEuZXlKZmMyUWlPbHNpTkdoMVpUTnVabkpFYVRoUk55MVBaM05sUlVadVNsWmtiM2w1V21nM04xaHVVSFkxU1ZWcGRtWnBXU0lzSWxJMGRIbENRbGhDUVhoYVluWnFUSE5wV2kwd2JGRjVOVzVHZGtkZmVsTk1kM0F4VmtNelVqTmthMUVpTENKYVN6Vm5SMmt0WW5OV1FYTnVNVXRqYlhCeVRsOWxSbDluZERGRmRsSTJaM015WWxKb01uRXllV0pOSWl3aVRWY3dRMmxZVTFoNGNVdzRhRVIzV0RscFVWSmFRM2gyU1hWSllrRnNZVlV6TFZCdVZYSTBVM294TUNJc0lqTmxibm8zVlRKeloycFJaalV3T0VFeWVIZDBNRkZsUmpjek0xVTRiVzVOTkVKWmJUbE1kbXR0UTJzaVhTd2lYM05rWDJGc1p5STZJbk5vWVMweU5UWWlMQ0pqYm1ZaU9uc2lhbmRySWpwN0ltTnlkaUk2SWxBdE1qVTJJaXdpYTNSNUlqb2lSVU1pTENKNElqb2lNRGxFTTFGTlExWTJWWFphZG5BNVF6UlpNekowUVVGWVYyVldZVkY2WjNCdVFYZGhaRzVtVmtab1NTSXNJbmtpT2lKSU5qSm9lRzlZUVdwVVQxVXlSR3RKTmtSdmJtcDVUVnBVTm5vM1Z6TndaVzV6WlVSVVlXSlhkVlp6SW4xOUxDSmxlSEFpT2pFM056VXhNelUzTVRnc0ltbHpjeUk2SW1oMGRIQnpPaTh2YzJGMGIzTmhMWFJsYzNRdE1TNXpkVzVsZEM1elpTSXNJbTVpWmlJNk1UYzBNelU1T1RjeE9Dd2lkbU4wSWpvaVJVaEpRME55WldSbGJuUnBZV3dpZlEudlJxeWJoX0UzbnZTMnp6VU5GZGNZN3djY21tck96RDdhOENFSFVudlBwaWFKWmNURF9DcXVKUWJiZnhDVnhnOHZBUDE5LTNnNkZqYXJhWWpVRUk4VlElN0VXeUpsU0dsamIyTldlSE0wVFVwclVHbEdXa0UzVFVKQklpd2ljM1ZpYW1WamRDSXNleUprWVhSbFgyOW1YMkpwY25Sb0lqb2lNVGs0Tmkwd05pMHhPU0lzSW1aaGJXbHNlVjl1WVcxbElqb2lWMmx1YzJ4bGRDSXNJbVp2Y21WdVlXMWxJam9pUzJGMFpTSjlYUSU3RVd5SlpUa2hWV0Zac1puQXphRW94YWxka1JFSXhaV1ZCSWl3aWMyOWphV0ZzWDNObFkzVnlhWFI1WDNCcGJpSXNJalUyTnpnek5Ea3dJbDAlN0VXeUkwU2xwV1JUbE1aa0ZaYWw4NGVrVk1iM05aYWpCQklpd2laRzlqZFcxbGJuUmZhV1FpTENJM09Ea3dNVEl6TkRVMk56ZzVNREV5TXpRMU5pSmQlN0VXeUoxVWpOMGFIbEtXVFZxZFhaR1NGTlliR3ByVUUxM0lpd2lZMjl0Y0dWMFpXNTBYMmx1YzNScGRIVjBhVzl1SWl4N0ltbHVjM1JwZEhWMGFXOXVYMk52ZFc1MGNua2lPaUpHVWlJc0ltbHVjM1JwZEhWMGFXOXVYMmxrSWpvaVEweEZTVk5USWl3aWFXNXpkR2wwZFhScGIyNWZibUZ0WlNJNklrZHliM1Z3WlNCRFlXbHpjMlVnWkdWeklFVERxWEREdEhSeklHRnpjMmx6ZEdWa0lHSjVJSFJvWlNCRFpXNTBjbVVnYjJZZ1JYVnliM0JsWVc0Z1lXNWtJRWx1ZEdWeWJtRjBhVzl1WVd3Z1RHbGhhWE52Ym5NZ1ptOXlJRk52WTJsaGJDQlRaV04xY21sMGVTSjlYUSU3RWV5SjBlWEFpT2lKcllpdHFkM1FpTENKaGJHY2lPaUpGVXpJMU5pSjkuZXlKdWIyNWpaU0k2SWtWTWFDMTVMVXBvV2pkeGVHWXljbEJyU0hveVQyTlZjMnhNV0habVZ6VnFNMXA1ZFU5eVUyTm1iVzhpTENKaGRXUWlPaUoyWXkxcGJuUmxjbTl3TFRNdWMzVnVaWFF1YzJVaUxDSnpaRjlvWVhOb0lqb2libVp4ZEhsTVJVUlhlbWRWUmxoV2RUZDVjblV0U25GU1MxSk1iazVPZG5jNWJVcFNNVlIwVmxCblRTSXNJbWxoZENJNk1UYzBORGd3TWpNek1IMC5DVXJjNUtlLVdLdks0a0pHZVdtUUdsSkJXSVJwTTRuYlNoS2x5TlJhZzVvY2Z4X1VCdHBDNmN2YS1LV2dOYnQyanlydUFUVVpwdldGVXJxd3NwQkZ3USZwcmVzZW50YXRpb25fc3VibWlzc2lvbj0lN0IlMjJpZCUyMiUzQSUyMmZjOTEyMzA3YTZiOTFhMDUlMjIlMkMlMjJkZWZpbml0aW9uX2lkJTIyJTNBJTIyU2F0b3NhRXVyb3BlYW5IZWFsdGhJbnN1cmFuY2VDYXJkJTIyJTJDJTIyZGVzY3JpcHRvcl9tYXAlMjIlM0ElNUIlN0IlMjJpZCUyMiUzQSUyMlNhdG9zYUVISUMlMjIlMkMlMjJmb3JtYXQlMjIlM0ElMjJ2YyUyQnNkLWp3dCUyMiUyQyUyMnBhdGglMjIlM0ElMjIlMjQlMjIlN0QlNUQlN0Qmc3RhdGU9NDMwOTQwOTgtOTQ5OC00ZDU1LWIwMjctNDI3NDdkNWIyMmMy"

var walletresponsebodynonjwe = "dnBfdG9rZW49ZXlKMGVYQWlPaUoyWXl0elpDMXFkM1FpTENKMlkzUnRJanBiSW1WNVNqSlpNMUZwVDJsS01XTnRORFphV0ZacllWUndiR0ZIYkdwUGFrVnBURU5LZFZsWE1XeEphbTlwVWxWb1NsRjVTWE5KYlZKc1l6Sk9lV0ZZUWpCaFZ6bDFTV3B2YVZaSGFIQmplVUp3WTNsQ2FFbEZWakZqYlRsM1dsZEdkVWxGYUd4WlYzZ3dZVU5DU21KdVRqRmpiVVoxV1RKVloxRXlSbmxhUTBJeVdsaEtjRnB0YkdoWmJYaHNTVWRPZVZwWFVteGlibEp3V1ZkM2FVeERTbXRoV0U1M1lrZEdOVWxxY0dKbGVVcHpXVmMxYmtscWIybGFWelIwVmxaTmFVeERTblZaVnpGc1NXcHZhVkpWYUVwUmVVbHpTVzVLYkdKdFVteGpiV3gxV25sSk5tVjVTbnBoVnpGM1lrZFZhVTl1YzJsWmJVWnFZVEprZVdJelZuVmFSamxxWWpKNGRtTnBTVFpKYVUxNFdXcEpNazB5U1dsTVEwb3dXbGhvTUZneVRuWmlSemw1U1dwdmFVa3dXa2RTYTFwSFVtbEtPVXhEU25wa2JXUm1aRWRXZEdOSGVHaGtSMVo2U1dwd1ltVjVTakZqYld0cFQybEtiMlJJVW5kamVtOTJUREpTYkdKWE9IUmhXRTU2WkZkV2VVeHVaRE5rTWtaellrZFdNRXh0T1hsYWVUbHdZbGRHYmxwWVRYWmtSMVowWTBkNGFHUkhWWFJhVjJod1dYazFlbVJ0WTJsbVZqRTVabFl3YzBsdFRuTlpWMngwWTNsSk5sY3pjMmxqUjBZd1lVTkpObGQ1U25kYVdFcDZZakkxYUdKR09XaGFSekZ3WW0xc2VtUklTbWhrUjJ3eVdsWTVkV1JYTVdsYVdFbHBXRk4zYVZwSGJIcGpSM2hvWlZOSk5sY3pjMmxpUjBaMVdubEpOa2x0Vm5WTVZsWlVTV2wzYVdKSFJtbGFWM2RwVDJsS1VWcFlTbnBpTWpWb1lrTkNTbEpEU1hOSmJWSnNZekpPZVdGWVFqQmhWemwxU1dwdmFWWlhOWEJqV0Zac1NVaENiR051VG5aaWJVWnpTVWRzYTFwWE5UQmhWMXB3V2xoSloyUllUbXhhUTBKcFpWTkNlbUl5VG5CWlYzZG5ZekpXYW1SWVNuQmtTR3RuWXpKV2VXUnRiR3BhV0UxMVNXNHhaRXhEU25wa2JXUm1ZVmRSYVU5cFNuZGFXRXA2WWpJMWFHSkdPV2hhUnpGd1ltMXNlbVJJU21oa1Iyd3lXbFk1ZFdSWE1XbGFXRWxwWmxONE4wbHVRbWhrUjJkcFQyeHphV0ZZVG5wa1YyeDFXakU1YW1JelZuVmtTRW8xU1d3d2MwbHRVbkJqTTBKeldWaHJhVTlzZERkSmJYaG9ZbTFqYVU5cFNteGlhVEZXVlhsSmMwbHRlR2haYlZaelNXcHZhVk5ZVG5wa1YxWjVTVVZPZG1SWE5UQmpibXRwVEVOS2ExcFlUbXBqYld4M1pFZHNkbUpwU1RaSmJGSnZXbE5DY0dNelRqRmFXRWxuV1RJNU1XSnVVbmxsVTBKMldtbENNR0ZIVldkU1ZXaEtVWGxDYjJJeWVHdGFXRWxwWmxZd2MwbHVUakphTVRsd1drTkpOa2x0Ykhwak0xWnNZMnc1YW1JelZuVmtTRW8xU1c0d2MyVjVTbmRaV0ZKdlNXcHdZa2x0Ykhwak0xWndZbTFrWmxsWVZqQmhSemw1WVZoU05VbHBkMmxoVjFGcFdGTjNhVnBIYkhwalIzaG9aVk5KTmxjemMybGlSMFoxV25sSk5rbHRWblZNVmxaVVNXbDNhV0pIUm1sYVYzZHBUMmxLU21NelRqRmhWelZ1U1VkR01XUkhhSFpqYld3d1pWTkNjRnBEU1hOSmJWSnNZekpPZVdGWVFqQmhWemwxU1dwdmFWSlZhRXBSZVVKd1l6Tk9NV0ZYTlc1SlIwWXhaRWRvZG1OdGJEQmxVMEl4WW0xc2VHUlhWV2RoVjFKc1ltNVNjRnB0Ykd4amFVSndZbWxDUmxKV1RsUlRVelJwWmxZd2MwbHVUakphTVRsd1drTkpOa2x0Ykhwak0xWndZbTFrWmxsWVZqQmhSemw1WVZoU05WZ3liR3RKYmpCelpYbEtkMWxZVW05SmFuQmlTVzFzZW1NelZuQmliV1JtV1ZoV01HRkhPWGxoV0ZJMVNXbDNhV0p0Um5SYVUwcGtURU5LYTJGWVRuZGlSMFkxU1dwd1ltVjVTbk5aVnpWdVNXcHZhVnBYTkhSV1ZrMXBURU5LYzFsWFNteGlRMGsyU1d0c2VtTXpWbkJpYldObldWaFdNR0ZIT1hsaFdGSTFTVWMxYUdKWFZXbE1RMHByV2xoT2FtTnRiSGRrUjJ4MlltbEpOa2xyVmtsVFZVMW5ZVmhPZW1SWGJIVmFlVUpvWkZoU2IySXpTbkJrU0d0blltMUdkRnBUUW5CaWFVSkdVbFpPVkZOVE5HbG1WakJ6U1c1T01sb3hPWEJhUTBrMlNXMXNlbU16Vm5CaWJXUm1XVmhXTUdGSE9YbGhXRkkxV0RJMWFHSlhWV2xtVTNnM1NXNUNhR1JIWjJsUGJITnBXa2M1YW1SWE1XeGlibEptWW01V2RGbHRWbmxKYkRCelNXNU9NbG94T1hCYVEwazJTVzFTZGxrelZuUmFWelV3V0RJMU1XSlhTbXhqYVVselNXMVNjR016UW5OWldHdHBUMngwTjBsdGVHaGliV05wVDJsS2JHSnBNVlpWZVVselNXMTRhRmx0Vm5OSmFtOXBVa2M1YW1SWE1XeGlibEZuWW01V2RGbHRWbmxKYVhkcFdrZFdlbGt6U25CalNGSndZakkwYVU5cFNrWlRSV3hFU1VoV2RXRllSakZhVTBKcllqSk9NV0pYVm5Wa1EwSndXa2RXZFdSSGJHMWhWMVo1VEdsS09WaFlNSE5sZVVwM1dWaFNiMGxxY0dKSmJWSm9aRWRXWm1JeVdtWmFXR2gzWVZoS05VbHNNSE5KYlZKd1l6TkNjMWxZYTJsUGJIUTNTVzE0YUdKdFkybFBhVXBzWW1reFZsVjVTWE5KYlhob1dXMVdjMGxxYjJsU1dHaDNZVmhLTlVsSFVtaGtSMVZwVEVOS2ExcFlUbXBqYld4M1pFZHNkbUpwU1RaSmExWkpVMVZOWjFwWWFIZGhXRXBvWkVkc2RtSnBRbXRaV0ZKc1RHbEtPVmhUZDJsak0xcHVXREpzYTBscWIybGFSMFl3V2xZNWRscHNPV3hsU0VKd1kyNXJhV1pXTVRraVhTd2llRFZqSWpwYklrMUpTVU40YWtORFFXMHlaMEYzU1VKQlowbFZURzV5ZUhWNE9YTkpNelJ2Y1dKaWVUTk5OR3hUUzA5ek9HOWpkME5uV1VsTGIxcEplbW93UlVGM1NYZFFla1ZNVFVGclIwRXhWVVZDYUUxRFVsWlZlRVpVUVZSQ1owNVdRa0Z2VFVSSVpETldNa1p6WWtkV01FeHRPWGxhZWtWYVRVSmpSMEV4VlVWQmQzZFJaRE5rV0ZsWGVITmFXRkZuVlcwNWRtUkRRa1JSVkVGbFJuY3dlVTVVUVRCTmFrbDRUVVJSTlUxVWFHRkdkekI1VG1wQk1FMXFTWGhOUkZFMVRWUm9ZVTFGUVhoRGVrRktRbWRPVmtKQldWUkJhMVpXVFZKVmQwVjNXVVJXVVZGTFJFRjRNMlF4WkdoaVIzaHNaRU0xZG1OdFkzaEhha0ZaUW1kT1ZrSkJUVTFGVjFKc1lsYzRkV1F6WkROWlYzaHpXbGhSZFdJelNtNU5SbXQzUlhkWlNFdHZXa2w2YWpCRFFWRlpTVXR2V2tsNmFqQkVRVkZqUkZGblFVVjBSblI1YTNWSGNpdElOQzkwVldwYU16SjNjM1F6VEdVeVpHSkRaakk0VG01WFFsWTNTM1ZSYVZKMFRXNXhZVWcwU1doNU15OWpORmwwT0hSRWRIUndLMlJqY25ad05tdHNXbTkyVGt4MmJFVnhLMDFxUzA5RFFWVlJkMmRuUmtGTlFqaEhRVEZWWkVsM1VWbE5RbUZCUms1Q2VISjBNQzkyTVhGdlpEaHFXVzQ0TDJKRVdHWm9lbmRWZFUxQ01FZEJNVlZrUkdkUlYwSkNWRWQ0VWs1YU1ITnpOMWxqYm5KNE5IRkVha3RhZUU1TFNGWjFha0ZQUW1kT1ZraFJPRUpCWmpoRlFrRk5RMEkwUVhkTloxbEVWbEl3VTBKRGMzZExXVVZTWVZjMWJXSXdRak5rTTJSb1lrZDRiR1JETlhaamJXVkhSa2RvTUdSSVFucFBhVGgyWkROa00xbFhlSE5hV0ZGMVlqTktiazFDU1VkQk1WVmtTbEZSVEUxQmEwZENlV2xDYWtZd1JrRlJTWGRFUVZsRVZsSXdWRUZSU0M5Q1FVbDNRVVJDUlVKblRsWklVamhGVUZSQk4wMUViV2RPTmtFeGFHcE9iMlJJVW5kamVtOTJURE5rTTJReVJuTmlSMVl3VEcwNWVWcDVPWEJaVjA1b1RESk9lV0pET1ROa00yUm9Za2Q0YkdSR09YWmpiV1JtWVZkR2FsbFROV3BqYlhkM1ZXZFpSRlpTTUZKQ1JYTjNVMWxKVWxwSFZuUmllVFV6WkROa2FHSkhlR3hrUXpWMlkyMWxRMGRIVW14aVZ6aDBZVmhPZW1SWFZubE1ibVF6WkRKR2MySkhWakJNYlRsNVdqUkpZVnBIVm5SaWVURXlXbGhLY0ZwdGJHeGphVFV6WkROa2FHSkhlR3hrUXpWMlkyMWpkME5uV1VsTGIxcEplbW93UlVGM1NVUlNkMEYzVWtGSlowNXlMMjFpTjNVeWRqUTVPRFJFYlRSRVZEWk9UVmRJYmxsalNqYzFMMFp2ZDFKNlVFVXJSSEY1V2tsRFNVWnBNWGRHU2taVGVVVk9kMHh3Y3pCVGNXTlpOR2xZTnpSeldrMWtVMkpxYmpGYWVERk5RVlIyYTBjaVhTd2lZV3huSWpvaVJWTXlOVFlpZlEuZXlKamJtWWlPbnNpYW5kcklqcDdJbU55ZGlJNklsQXRNalUySWl3aVpYaDBJanAwY25WbExDSnJaWGxmYjNCeklqcGJJblpsY21sbWVTSmRMQ0pyZEhraU9pSkZReUlzSW5naU9pSlRURWszVWw5cE1GbHBWWEpoYlRGWlZEVkxSV2MxVTBWaFVGbHJNbVJQZFY5SGQyTlFWRUZDVHpkRklpd2llU0k2SW1Gd05XTmFUSEJFTjBOQ1pqVlZaa3RrWjNvM1UwdGxMWGhGYldnNVNEQlJRVFJxTTBOeGFUSnFjRkVpZlgwc0luWmpkQ0k2SW5WeWJqcGxkV1JwT21Wb2FXTTZNU0lzSW1wMGFTSTZJblZ5YmpwbGRXUnBPbVZvYVdNNk1UbzJNekkxTXpFNE15MHlNekUwTFRReE5EQXRZamRqWkMxak56UXlZVEkyT0dZellUUWlMQ0pwYzNOMWFXNW5YMkYxZEdodmNtbDBlU0k2ZXlKZmMyUWlPbHNpWkVGelVWaFVTazA0U1RNdFZISTFaM1l4Wm5rMlRUZEVUbkpVTFRRdExVTnJVMU4yYzJOTkxXWmtkeUlzSW5oVU9EVTRPVkpCVTJ0aWVGbGFlalZ4TlcxSU9VeERjRWR3T0RWTmJuRm9VRkZDYkZKNWRIVlJWbEVpWFgwc0ltbGhkQ0k2TVRjME9ETTBNemd6TUN3aVpYaHdJam94TnpjNU9EYzVPRE13TENKcGMzTWlPaUpvZEhSd2N6b3ZMMlJsYlc4dGFYTnpkV1Z5TG5kM2QyRnNiR1YwTG05eVp5SXNJbk4xWWlJNkluTnZWVFZ1YjFsdk5sQXRRMWR4VlRWc09VeEJOR2hCV0dWd05sRXdXV1kwT0Roa1ZFeHVNSFp4YnpBaUxDSmZjMlJmWVd4bklqb2ljMmhoTFRJMU5pSXNJbDl6WkNJNld5SXRVRTV2VGs0eGVEQlNjVGRqZVdSaWMzTjBNSGhXTjFjM2R6bElMWEl5Tldka2RVVlRhRVF5U0Zrd0lpd2lTM1oxU1c1bmJtRTNhbGxvZWpoTlZGcEdUMlZSWlZwak1WcFVNbTFXVjBSeWQySmZkMFpxZUZSU1dTSXNJazFGTmt4WGJHMXZNMmRqU20xS05sVmtlbEZrWlUxNlRWQjVZV2wyV1c1bE1HUlhkMXBuZW1oSWIwa2lMQ0pTUjBaaE0wWkdTMGxHVUhSNVMxOHdiM3BTUVVOT1EySjNXVkJxVG04MlVrNXRhSGRhUlVGa05FRjNJaXdpZFdaQ1RrSTJTREUzVkVSTmQxWkxVVll0YWtWR1JTMW5RVGhKWTJZMU9IUkNhMWhSUWpWSVZVUmhkeUpkZlEudi1SX08yOENkSl9tbzEzSTNLa2psWTBvQ0ladmczRUlpQm1JcElhdkY5TVVkeTN3UXBBam9KNV9zMlV0S3FVVXEtMnlQN2NSYmNNaHcyXzBqRnVyb3clN0VXeUoyV1haTlNWWkxReko1YzNKMlYxTlROMnhQTFdGUklpd2ljR1Z5YzI5dVlXeGZZV1J0YVc1cGMzUnlZWFJwZG1WZmJuVnRZbVZ5SWl3aU5USXpNVE16TVRNeU1UWWlYUSU3RVd5SlRaR3QxUzJsdGNXOWpTVlV5YnkxRVdESktVRXhSSWl3aVpHOWpkVzFsYm5SZmJuVnRZbVZ5SWl3aU9UZzNOalUwTXpJeElsMCU3RVd5SlpaamhVYnpaYVNWUkpUbkp0TW5wRFdXNXRjV2huSWl3aWFYTnpkV2x1WjE5amIzVnVkSEo1SWl3aVJFVWlYUSU3RVd5SlNaM0JJTUhGSWFEVlJPR0l4VFROb0xYZEVURVpuSWl3aWFXUWlMQ0l5SWwwJTdFV3lKYWJtTnZlV2REU201UU4yRlNOR3RqT1ROcVdqVjNJaXdpYm1GdFpTSXNJa1JGSUVsemMzVnBibWNnUVhWMGFHOXlhWFI1SWwwJTdFV3lKcWVFaFlXRUpPV1dSSlV6SlhhWEJSUTAweWQyeFJJaXdpWkdGMFpWOXZabDlsZUhCcGNua2lMQ0l5TURNMUxUQTBMVEl4SWwwJTdFV3lJNGRIZExVa2xqY2tKM0xUQklOR0ZyTUhWeVpXWjNJaXdpWkdGMFpWOXZabDlwYzNOMVlXNWpaU0lzSWpJd01qVXRNRFV0TWpjaVhRJTdFZXlKMGVYQWlPaUpyWWl0cWQzUWlMQ0poYkdjaU9pSkZVekkxTmlKOS5leUp1YjI1alpTSTZJbkJaYUZocFgwVlVUMmhZYUZoa1NGTnBkRkJsUTFodk9EVk9NWEpsVFhKM1ZIWkZWMGswU1VoMWNFa2lMQ0poZFdRaU9pSjJZeTFwYm5SbGNtOXdMVE11YzNWdVpYUXVjMlVpTENKelpGOW9ZWE5vSWpvaVNsWk9WbGRPVHkwMU5tZEZjbWN5WTFCallXdG5kMUZtVTJsMlVYSllOV1paWmpWQlJtd3RRM2hQTkNJc0ltbGhkQ0k2TVRjME9ETTFPRE00T0gwLlJkNW1OdkdnZGJ3a2IxWDJjd05wR1c1SkR1YThjUENqa2p0dU41bXM1cDh4LVR0YVVCMlFURVZSREcyNVBieUFMQXltQjNJc25QUGMzbDhCWEJRTHF3JnByZXNlbnRhdGlvbl9zdWJtaXNzaW9uPSU3QiUyMmlkJTIyJTNBJTIyNWMzM2Q3YWFjYjhjZjg1ZiUyMiUyQyUyMmRlZmluaXRpb25faWQlMjIlM0ElMjJFdXJvcGVhbkhlYWx0aEluc3VyYW5jZUNhcmQlMjIlMkMlMjJkZXNjcmlwdG9yX21hcCUyMiUzQSU1QiU3QiUyMmlkJTIyJTNBJTIyRXVyb3BlYW5IZWFsdGhJbnN1cmFuY2VDYXJkJTIyJTJDJTIyZm9ybWF0JTIyJTNBJTIydmMlMkJzZC1qd3QlMjIlMkMlMjJwYXRoJTIyJTNBJTIyJTI0JTIyJTdEJTVEJTdEJnN0YXRlPTI1ZTlkNzZmLTczNzUtNGVkMi1iMTk0LTE1ZjVhOTE4MWUyNw=="

func TestService_endpointCallback(t *testing.T) {
	fmt.Println("Start")
	//TODO: nedan kan i metoden toResponseBody läsa ut innehållet före det blir fel
	//responseBody, err := toResponseBody(walletResponseBody2SomNogInteIsJWE)
	//if err != nil {
	//	fmt.Println(err)
	//} else {
	//	fmt.Println("JWE=", responseBody.Response)
	//}

	//ar, err := toAuthorizationResponseBody(walletResponseBody2SomNogInteIsJWE)
	ar, err := toAuthorizationResponseBody(walletresponsebodynonjwe)
	if err != nil {
		fmt.Println(err)
	}

	fmt.Println("JWE=", ar)
}

func toAuthorizationResponseBody(encodedBody string) (*openid4vp.AuthorizationResponse, error) {
	padded := encodedBody + strings.Repeat("=", (4-len(encodedBody)%4)%4)

	decodedBytes, err := base64.StdEncoding.DecodeString(padded)
	if err != nil {
		return nil, fmt.Errorf("base64 decode failed: %w", err)
	}
	fmt.Println("### DECODED BYTES:", string(decodedBytes))

	values, err := url.ParseQuery(string(decodedBytes))
	if err != nil {
		return nil, fmt.Errorf("url parse failed: %w", err)
	}
	fmt.Println("### VALUES FROM PARSED QUERY:", values)

	var p openid4vp.AuthorizationResponse
	err = json.Unmarshal(decodedBytes, &p)
	if err != nil {
		log.Fatalf("Failed to unmarshal: %v", err)
	}
	return &p, nil

	//return &openid4vp.AuthorizationResponse{}, nil
}

func toResponseBody(encodedBody string) (*ResponseBody, error) {
	padded := encodedBody + strings.Repeat("=", (4-len(encodedBody)%4)%4)

	decodedBytes, err := base64.StdEncoding.DecodeString(padded)
	if err != nil {
		return nil, fmt.Errorf("base64 decode failed: %w", err)
	}

	values, err := url.ParseQuery(string(decodedBytes))
	if err != nil {
		return nil, fmt.Errorf("url parse failed: %w", err)
	}

	return &ResponseBody{
		Response: values.Get("response"),
	}, nil
}

func Test_callback_dev_support_util(t *testing.T) {

	body := "cmVzcG9uc2U9ZXlKaGJHY2lPaUpGUTBSSUxVVlRJaXdpWlc1aklqb2lRVEkxTmtkRFRTSXNJbXRwWkNJNklqUTJOelJtWkRGa0xXSTFOVEF0TkRZNE15MDVNV1U1TFRjMFl6Y3lZelU1WWpGak1DSXNJbVZ3YXlJNmV5SjRJam9pVkVGRk9ESlFkRzEyVG1aNFRVdEllamhVWVdFd2VGOWpVamxWUmtGcmIya3lVSEZIWW04eGRHSm5aeUlzSW1OeWRpSTZJbEF0TWpVMklpd2lhM1I1SWpvaVJVTWlMQ0o1SWpvaU9FcFRkMDFUUzJaUFNpMDRaMTlGYlhSTVNHVkxWVkpXTFRGUFdEa3djMjlVTjA5UWJ6TlFiSFl5VlNKOUxDSmhjSFVpT2lJaUxDSmhjSFlpT2lJaWZRLi5ub3gtZDRqS1ZhbER3RHpWLkFPMWtOQU1IUkVXODFaZERxcldXNTZLdDItaGstSVd1aDhFc1g4OEVzLWNlaTVxakRkZmVkVmNnbHRiR0xmcHhRa1BDeDhfZWk4TTZQSmw3NzEzTzdIelJwNThPWlpJSUtrXzhHMlh3OS1qeDdJVDJOakZpcDFYVk9OSmtfV0Y4ckkxNVAwMGw1eTVWWk43d2taLW5aS3l3akYwX0FCVlFaZVAxUFQ4NXhnTGlRR28wWS1PTlZzNEJJSGxJUXdDSlVadzktQTVMaVJXcHNKYVptaktXa1QzVlJVUXk2MDlBME42MUthTWZ5Y05yVmRfUUVTVVEzRkdGN3E5ZHExUGNlV0pFaWdMMkJWU2l3NTZUVGZMR2w2aEM5NE9KMlZHZE81Q2l5LVd1b3ZyYW1tZ0pYRmJQcGo0ZGw3ZENBa0RNVmpNUkxCbFV5dV9YMWdETFNQUXFFZ3JITmJ5bm1nb3FKMzB1cFBHZ0wyNVNMeTdDMjBMdDJaOVMwMVp1S3kyRk4yS21ZUE4taU1KOWFLRVNkY0JQZl91VjBEcmc2MWZ1c29ES1ZwVGVoeG1xWWozLXhYWVpaVnpOdDR3WC1PbDNPYlM3MVFtSGtvRzM5akw4WmhUZDFGQTdzSjZXRWxyckxCeFdDc2h2OFY2NFF3cV9oSEtjR05lRjFkSjNhdlQwWXFqa21xMGFNTFMtOG02RjViQk80WDFnUDB6dWswNzFDY3RhY3lzODIyTWRlZ0tacXRIVWI4X3FEX3ZPVzl5a3U4Y2FYc0RiNnlwQWpxUk9hWGVyOUw5aVRpd2RDMjl4QkVCbE9uMUNnVmhMbV9saHRuanFpRGl0Z19DUUY3T1BWa01QTDhBWlk4Nk53OGVCd3pmVEY4c1JlRXRRQUxQWlc1Z2w5bVhMd01QTVl3WmotcS0wR3ZKRHhqQ04tOWRIdnFIQ3dtY25rUGpBbG5EYk9OMkpfZlFIejF3ME1tdE9FWDRLVUZPVXZ4cVV2TnF5UkZJcjNnakNkZGdyNHk5V19sRXRPZ3pWTHpQRmpsRlMtcDg0Tlg0YlFJay1SSTZYTG5QLTRGTklhX2pQSFd0bUthS3pBQm1HNlR6YldrdDdzZlB3dDlTNjhtNzhLVFlmdElpQ3BReU04VUZZUVJHRGY1Y2cwUHA4VmFnQWs4Slo0SFZHSFNmckZjZ1p6bGFQUDlxeEhJbEF2aDhPdFVZOHd6V1QwYWNFbXJSSEtQWUJ0QnoyLUxsMmtTZkxQQ2FmUHhWTVpfR0IxZ3FrUXZYSXZCaklxVFFDaDN1ZFE1WGprdnd3OGJPdDkyRUZQQ1ctWWxUdDBjMXlET1VER1RFRVpoYmNCcmVIQU42VTdFTFMwWXM3MVJxdkRFaVRRTk9QUU1CemtQekctVW1rcndTSnFaWml5OXNFNU1kVWo3RGd0dUx3SnAxWU14QUVacVNmUmRFT0s3Ul9tNW5TVDF4dkQwaTNPRTV3dWlJcHc2Tk1iZ280amh2RkJOM2E2Z3p6RHVaQm1ieG1EVWdjU1pvOWd3NUtJZl9iRTk4d25EQno3dkZSbUpBV1VZRUNDMElCOG05WW1TdFk4bEJZOWhfUy10dmJuUVJobVQ5elktal9iVHZKUzRiaWN2bWZOTDkxbTJ6NFRQOUw3NjZNNVR3ckFKaVRWMktNeXZVelJHZXVib19FWmxLMEQtV3NZdzVjYlJBbHFCREhzemIyTXg0blB5RHJDVGZYRWNfNDh3eU50SDhDenluWklrWm9HakNZN081VXpjazM5eTY3Vld6OWhUa094UTlhTmVfUjVCSXFxdU4xbWFkamxZWW9OLTAtN2JZUGh3OEVuWkRoSVR4NjJGT1RFLUNHRi1iMXJpMmtueTZqcU9MWjBUSXBSRDlPMjM4aUp5SkUxM2cya29CYk1IOEF4aDNHWHhyZFpaTDU5SjdHRWt4WU5wQWY1bnlONWZ4Zm5WQ3ZMTEs3TzlCMmlyeFc2X3FsQVFGak5vbWtHdmJOTFJ6UzZNMGRDb2pMSDJ6X2JZQUxxUkljRHVEYlFsRklPOF94R09hWHU4bGc0eTZzNW1UTkh6aW1Tek1VV1FveFFSLUkwcEZqXy0yQ1c4MUpaX1Z6YUZhd01mQTNsa3BpQUE2WWZSZ19qenF4aDZfdWFuNWpxM2J2Vko2NG1mTTBLWVkzemowLXAzRnQ3WlZrbllNYkwyY2FRLUFmd1diNV9YN3FRZnZ4a0dTV3ZrZndaS05wV2hGMFJSOHN5MDN5MURJVTJKU0lEU0ZRY014REZUQll3MVd5WHp3dWcxa2kxQUZpWVpQMndXSlFiX0xGelltXzNCQjFxOHZOUlhVMHNKR0VkYVYweVB3ZzFYYlhaazJfYU10WERtTnZ5aFN2YW1rV3FOZXBtbERDZ3BZSHZiMVdpaFY5bVlvYVRfbW1WRmtxb0lQRHVFVC1OR0RWakU1Sy1YcmU4R25qSE9TcVFIUDBFWDd1aTFOZHhhcm42SktHVW1EakNTMUZ3WERTenowc3JoZlJOYzdKUVBmZ3JVV1U4UlVqM2RwSkpVaFJLNFVKOGJMN2VQdUo5djdDREtqYl9ETjdJUUp1WVJnR0FXeEdRUHJSVXpveER0V1pTY1dINEtoUXZCY1h6V1dtV25LeVBjS3VsNVdZRDBZZDUwOUZUMGZuR09fTHhfSXFtbU5hRVpUeUwxalN2UHlmelY1Zm1zMGI2Si1oMXZuWGFaNU1aakNKOTFyOEhTQU5OWEhGN1pERXJKV0R2eHpKdURlSjV0UjVLWGFpUVZkOE9xbHR3Ty1fdmtndkdkbEg0RFhZSXpOOWdGeldKR2JfQmFtZjZjUjdyMll6elVidUhyUmJ2Tk1EdEhQSEZzazBpb3RibEhVSWpPVFBYQ2FoT3J4N0cyaFl2ZXNBVTQ1NkxURHJpMVFJellhb2VKcFlWRS05UXZkRVQzSUgxV0MtM0QzZWk2VzQ5STJSUThuTWlOUnJiNHlhc19qQXBhV3NVTF9jVmh2dUVwc2J5OV94Y2FwSGJhdnE3Qm5ucTZOcnNxcjlkRlg3cGNQUzlfVXlzTEpGdU5OY1RUekxvRXRKdk53dTV2UE9TS09RT3JvODh0MEJpSEdpZlhPbkRTTEMyYnUzT0ZJZGxWTWh2MUVtOVI0cEhqUXgxdG1ZcXI1UG9XVEJqOG9mVllmZlRoV0Jqb2lqdk1Oc2s4VGhaNFNLU1pDNUZkd3VnU1lhMWRPRkhlYW95SDRnbzJ5SDB6Qm5GS3pOU3hUeVllWDJIQVlsQ2ZhUGZMN1hDanJ3R0ZhY1p1Vm92NUs1Zlh3aEZSdFZTa0ZWaFBPWkFMVDJockcxZURCZFZrYnl0WXJ1TXIybDFOcGpiRGRtOG9oMzhOMlV3OE1yejNlRlMwSWZqSzhsekVYdVlsSlJIb3ltYW1Rb0FjMVFBMENzX2JHcnppaC1kenBLNGt3Y2tVOENvZjFQUjlWa1BhclNvX2doQ2J4QUllQUw3ejRtclpwTS12dFlJYk44RGo4WTJqazNQTVpqZTR2MVdPaF9waEZUUFVETDFCdGh4cG1lZVdoTUdYUmRYVnFTUlVjcTg4TjJZemtkMEZ4TkdZUVQ4QkRpNnlhNThBQzFDN3ZVZl8wLVNSOUhXMWFCZHRVMFdkbGJrUURGRTJUWF85SkVhQU83SS1VWGhnX2g2RkRZUk0xUHVxX05mVDRlclNVOGo0eG9LWmM4VGhDU2Q0N29wdG9KdlpUYzBLZUxKUS0wX0tCeUgxcF85Nkd1TXdldW9hczdxSTVCd2RHOUFPR295WklyU1RKUEpPSlNxeUpJbUw1NHA5SEpPZGlOVnZGWjdjTlVJOWRxVXI0OVNlUEc5U3FGQjQ5Y3VZYnhKdHFncC1oVU85YnRTSzhha19vRURpaVE2dGV6cG9NblAxZEFnYnUyYzRjNUVDWDZuTThkeVVRZlM3eGhLblY3TVFMSDY2aXN5enRBREZXcjd6WkU5LWNWazlwOEFnT0dTYUFQSGN0Qm03RkFmdDkzMy0tdTMyYXJTQWFicjVORzkwUndYWHpOOTdjWnZWOFhqVFdlOWZzelZvbl8yN1dlRGwzeEQxbG00MW1BRzhGNFNZRGd2U2dKVVNzcHhaSXRSS3JXZ0YzcF96TUJwRmN4Z0R5TTNYeWdTcGNiZGZzZnF5YjlfLTZGN29CWXdoZW9ydUNIU1I1NTJvYnNNNFdYdTZtX2NGM0FYSnhuRVl5WDlPckhCQ3JzTm1CaUZLSmQyeVhEX1JaYkNhaEtRVWpIMWlLNFQxcFg4ZjVKUTBHSlFFXzhnQW1QazV4Y2JMeEEzTWpNUVJQYVZYNWd6S3JjakJicFdyd2xVMk44NmJaVkpxSjVNQUZmYzY3VFVMUmQtRWt4ak16VWwtNDR1YmRSN2dxUUI1alk4QnFBbzItNnVhTWRoMV9yTE01M2REa2JSdHBjTjhDanFXSEp4dVROUXpZVWxES0hIOVk4U1RTUmloN0Uyb3hhQm11d0c3NWd2Sks2c3NtMmlZX3F0MUVjMk13UzN6Snd1RFNXelgweG5lVWR4NVBkRU1wdHVNTFB5YTd5WTJuUGJsNzVKQU9ld056Ymg0d0k1YWFkeVZ0bF9TTzAySjRnTGxSY3pBYWZrZklYM3kza09VMG1qSUNZRGs2LUdnZ2prWVh3bjBiYnJVdGY5ejNTdDV1cUR5WU9kaVVWUGVLbGdIT3Q3NVJzUXpuejhVdW1UYUdZWWFOcENjYlcyUVc3TnNHcHI2M0c4d1Rsd0RvSlBDRElKa09OS2kyOUVyNlhsT1Jvb3FnUmpDa2gxckRsZmkzUERDdjhIb0wzYjg3WnZMMnBaTG8zcWZCbzA0NlRia0h5Ymx0Y21JYjhXUXhDZTFPZlp6emJqUUJkZENITTk0bnBMRWdmbmlSM0dzQzVjMjdycmNYT1RmTlcwN251YUU2M052MXF3WFBabEFvOEZDNkJjWDdCVUNYQlZFZzJRaTlNdVVtbmkzYlBTQ2lPeHJKTGpvdFV2aU90QXRZdjlNVjhUTm9vdElQWjNHNktXV2FrNEpEcVNwOGtoTGhYT0N2WC1zUTBuRXVEZUROOE1XMUd1NkFRZmYyd015QjBpV2gyQVh5LUZHRUNoOG1Db0U3Ql9JZmo3eFUzdXdHck9DS0pULVN3Z21Ea2dZWE1fSm5raktTekppVHRSV2NpNVQ1dnVvQmlJcHNTalJwVjAyN0lYRlNkYXV4Y2R2WTF2SGZOYXU0aDdlRkxQaWFCT0kxaDBFWW5OYXJEVDcwWWtSQkhhNWR5V2tESmJUdFZ2eEY1b21zM2JVdl9zMEhZRG5haDl4QzBRRk9lS0dpSEZ5Zzc5QWthdVlmWnRPN3hmTlJ4V1JoUmVIOWhsbnU3MDlFdEU3UXljdVc2NHBNTXJ6Yi12NVRqMnU4MVdmUHBVSnVmazB2QXlZVmVkTS1KekxKZjhNMTlGRlRaZnBVZWs4R3dTcjZwbmZ3cksxOXA0OXpuMno2VjJaV3pjRUZwUUE4MHB3M2tyRHFzbm54ZEVJQUc1S3E0ZXE5QVRhaWZpYllCUDZNUEw4N1VxdGpIclNVOEwtTkd4M19PUW9odl9udjVsREt0MXlXcGRCLVNpUW5XZW1nY2FiUkQwMEtCVlRUWXpHS1E4TW1naldKM2tGWVpUZ3ctUFVjclhEbWpGbXo0RkJHZ0tXYlhidUczeXZZMFFoRjhGbW1Ddk5meDh5NUdjcUtZSktKQWswX1JUSi1KbVdQNURwbXdCSDlWNlozbzh1T09vZVhZamQzTjRaWlVERE01R3N2QlRSTXJfLWljck9wbUhCZURyTUtmQnlFTTY2a0pBLTlDUDJ3S0VnVU5ZMTlWd09pNTdZVHRiaFp5enMxa0hfWHpEbXFwS3NkX1hRRFB5R0xMNVlRbVFrb0l1Vkd1N3hOSGRJRkw3ZzlwWmlDSEFnaEJuTXdNTURtMi1nNWhLSW1fNklESTRWb0ptR0tuRDZuNXVRV09VQ3FlR1lEMEJTNENLMUZDXzNrTXF2eFNqZzgwVHBqdTFOeUdLaTNVTE9hbFhpTlN3MXZCalJBLW5VS1pKZE5WdDhibF9PYjF1TjZMRHlKSURBOUVJWGE3YjFkT241Sl9EYWc2Z0FLX2FNelNBeGpDb1BfUGotV3QtX19kYmVRa05QVm01dTFPS1ZfSURrcVpENFl1d2d3ekhKeGMwdHE4RUdnV3pQcW9SeFQ3M3I4VXdCOS1ES3dlbzF5dngzVlpwSWtxOWNmeFdMOHhzNmUtU0dfdEhNbXJ3a1hRbUI1STNNbkI2Mkhrd0FHZXF3TkFOMDBNX1dEeGlpdVVKQjZPaEk4V2xEYWRWUXhkUTBVOVdlRUQzcllmS2VoVHhnWnhRYmpVeTFNVjdJcURfNUtHT0lZd2lyQURHR2thbG5rOHBOTldqbzlwZFJvbWd1Z2tFcW1qMUkxYWI1UEpTMlVrTXNjS1MyOV9JU3NhY0JsUjhLVExTOVhYdE9XdHI0dkJLenBjVlZqM3F3NEJHdzBDUDVBX1d1RWZzak84WkxyWlNwR0licjNCdk5kNzNRNGJYS1djeV9zOUd0MlkxTkl2RDREMVp4V0JPTUtKNUF2NjJFdDBtSGdKY092ZUZHTm9SYmp2YWs1VkY4SnkweDZIakVwWkxUb3I4Qm1pMHJvTzZiQ3NteHh4Q1FPS3JZSUNWeW1KQjh6LWJCUmhSVFZVRlAzSFV2MV9zSVpKSk12ZWttdVA5bTY4Q3VBNXFqcEM3VHhfYmZlN3VsOWxCYkhNRUxUSkNLUDVSa0NlTXBlaGZiM3RlSk9oaWZ4dFh2S3MtODQ2MGlkcVBCTEhkY0tUc0ZnV0FCbXAxWmdfay1sclRJb2QxajV2WEkzM3kxZ28tSzFDQnJoekNZTUQtdC16RmhrQW00RmpobzFVSUVUZDVqbUM3NE4tNzJacjZOZ2xlUVkxUG5BY2tCb2FOUU43RjlBaHpINUhJQ05fME43YjZrX292T3hrRzMzTHU5TE9EUFZqNEhGOVlHQ3VTWG9uM2NPZmpUUUtmcDRVTWRuTS0tWnpWTzNfWVgtcFkyN0VMMXJyenpmT3hpLUJtakdFcUZpRDB5Y3dGSzN5NDc4dVhrWElVTWVzMzlsQThuTms0TVNLSF9pR2xYS0J0dTEyenNQMjRrMVk2dUJpUGxYZlo2UWw0aHpCclF3RFRYZUJPd1RXWERfMFRuaDVkMnd1cHB5QzBUSlNwVmJsZUxkWjhCSHk0SFJGaW9LX3JRU3lsREZ0Z29IRi1mSVEzR0Etc3lCSGNIV09hOUIzS205WU90SjZwa3lXTE9KajNHVmRVaTZSdHBwZ0J5emFxT3FFLVhpVEZQSVg5X1g2ajQyNzlOc19lQlByYTVfdGp0OEVvcWFIYW1FZHRZVm0yUTRKdE9oX2VzczJQZ0pwRlJOVURRX1R5UUFwZ1puV2ZrWUd2RjZ4dlFlbHAyQTREamplMmZVUjNrOTVjXzNDMUNEOFFSOWxYSW1KeUdEb18wU3ZDUi1RaTBtZ3hwUjJQUUxZYzluS2lQS3h2MUcxUVQ1TzF4dDhaaFJ2V2tXSkMySmdqNkg1MUs4aHFNTEMtSkc2enQ3WjlxcnNPRnAzcUU4V1dQUXdkS3lXTVlJX1BEYzRGOHFEVnVwVnNRbUl2bXVVLURabmJucVNoaDFpZ2xidzhIZHRyT3dWdDB2WW5TTWxEaTF0RUxvSWRLbGRteEdEdXVnNnFiNkJscmx5bE9hR2MydnNPMmIyNVFId1gtRTdRVGlId3NpYXZ3RWpDNkhMcDJLcW95VUplMnZEZmZrM2lOOV8xa1RmVGtjeklmeTFDZW56LW9DUlA4NVBmSHJQRHFFLWN0TEhMc3dSQ2p4Y1B0VExKMkJCYUpDbVlaQ0ROUkZnYzBBdFdGeDZId0w4bTdHVUIwa0E2N2hfNjExaXo5M1dOYkpRWjBHQW94ODNoMnlram5rc2sxMVdkQkZyQWJIczRwNWdCSF9tZk14Qk9NaHlsUUpGcDdfTTFmaTBwZGkzLXRhTGJLY0E4WF9XVnRYWXBXbDhIVmFZWk9XdnpiTkQzdmVsUk8tekU5NkJfaWpnNTFUT09KRlFHU2REZUJZWVNtbVRtMHRMTklod2xUenFZbmJndHNmTjNTNTVYTjMtN1NiS0ZKWjhqbGhtRjFkN05uelZzNDl6bUNiaHM4NkJ5dHpOOVJhX3NEMVFtTkVaUE1JMTgyM2NjbnZqcWtpWVlwMFU5Q2RlRW5WOGRaSWZhRUVCRjdDaWpfcmtJdFpZYkM2TjlEZzFMbmJaVVd3S0xGUzAwbDl3Z01OU3VTY0dEczB4Ylpfek9mWEZPRkNmVmM4ZGNJNlFDcUpubU5xNWVkRGMyVU1RVC1GcUUzdXFUOXRQTTIycHBDLUU0cUlnaEtHaFVmWVhlTmpuYmdjRHJuYTRqcmRzMXJNcGFNd3VDVlJqXzloTHNlbzZxMWdKSU9wd09mTFBZa1lHNFZkd3ByckdDTzBXOENpMTFYYnRYREhldFlxRHZmNjJxOEdHRFFhR3o1bXlTUUEzSmtJTUdWLVhvY3FyUm5icnlnT0xGRVVpbFA5Z3VGX1Qwb3kwN1hpbHljUURYaFpJM3FGc3R2cXktY2ZvcUduQm43OF81cWVOdXg5cnBZd3ZJdGVFTEdTZ3BXVnlqOHJFNm43cjFnc3Bub250aVI0Q19Va2ZBNnJ4dTEtQS1mMGVVT3pEdk1DR3p1RGlNWHZkQVBtRTkxb25ZcFZHQVEzOTFVSmFtQmtSSkN1Vk5HUnRHS2o0amNUYUtBbVM3Njc2UmdhUk5IVUZpTTN0UWgzLWUwUWFIQ0p3MWdwRFV4TTFMd0swSmw3TnlGNHBTUk9nZ0NiTkJJNTZ3cTNRU3Nid014TVJEV1R1ZWRmU2lpaGtkLXd6Q0F3eEFVaERXUWcyQzhtT2pseGZOYTZtN1pVdnRoTEFSb0ZIXzVkbWJkSmh1RndRSEpiQnlvMEtxUHZWUlc0cVVIOXl0ZW1CTXF1NjN1OWc5Wm16VVRJSDE2Ym4xeGdTbXZ3ODFKeXVmX0ZqbHloWEstZVFfdU54YWRjUlZUUU0zcjRENGVaU2ktME5fS2c3aGR1OW9LbWFuYmR4Mm1rSXdfc1lEYWlBT1BUeWxXLTNycGQ0YmIxbmIySlV4T09CM2RUMFVOMnN6LS1XUVZsNFpxMmU1TUZlM1ZRWGxFbTRaeFNLU3MwV0s3ejZ1b1NaMDNndkZSSDZENEJadXBucmFtcVYwX3ltR050alV5b1RYbTVKUUt0MURENkFEcFZZN2xEZ0dOTWI5WVRBRUJxLXpLTWduZ1Fzel9ldVhrZGIxbXI2anpMVFBwRUY4ZW90ZXdOSk9FaHE0UUVhUXhFbmJ1ck1GVFFwT3pvSkY4T252TlFBZUhoWXNlV0k4bXlaVjV1SWlodlIxZHpqQkk0bmxDSkhBZEFEc3pHUmI0bUZReFR1QWs0QkNBUWg0RVJ0M2tTRWFCUFdqYmRfTHN0dGNHd0NqdEV2eFFJT2pmODdpTjN2QlNVdHFiajFQa1V2LU05ZVhEV1hBNmVaU0ktdzRnSFhwWnV5NkZIQ2V4ZDF6NEo5X1ZPMkxXb2FNTWVySVl3Z1hpTnZ3Z08tbkNMWkRyRXRySEtOV1lCNHp3MHZ1Q3kyNEY3cDRCLUtjUDlzRC1KS2lNTjk1RldNc1BCd05MTEl6aEJnYjM5cUZNQm1TZEptNUZ4YVJ1ZERFc29tOURpNl84YVlFN0tmN0xTQk9Zb014STF3RElVZ2dKT2I1V2hIaXVBbXI2dVN2aUxnOERJc2pxeGJtQzZMdUNYWHhTUkdVRk05MldfRDJyZnBLaEU0Nk1MZDFPYVlvbHVsVUhqVFBKS1lTbXBaVjFrRThDV0VocndOdndRMElLOElNcTJQUUxpeGhYQ1FmMXpobm0wODVCS2FUVUtqdFpNWEJkNHc5Qzg1S3pvZ3o0aElqVnRfWVBsMXAtWEpCZkRXTGV1cm84NGZ1ME5yM1RTaHFydDExejRUVFBLMHZtOHpGb1RHVVRJR2xSaGduaXEtOHk2OUtfUzMzczJ6NkxtRU5NN3Rqc04yNS1TUkRKc2JDeGQxVEw5M1pLeUEyS2x1S3pIMGVDdFlYcXFlN0x2Mk13aUFXTURGV0dwYzh5TTM1RWlFUGRLT0ZvMUVsSXloVU5kUk94T21jWUlLdDhuLXhSQ016a253a0NjdEFGTDNBLWcteDR4N1BUZmpkRHA0LWtWY3oyRy1GaXZSUVZEd0pCdU9ySWZJRlYtalVLbDNBMnBjQm5mazRnWE1OTmlYYWFVdEJINHR5cDhmazVXNWxlOUw3amwzdGxOR3RhLXV2QUwwMWpTQjlfQ3lhc1FuUm9jWWF0UmFsOVNDMzJWNm5Obng4VTBKX2t1SzdRb1pjNGszQWtDUWRkcDlKVkdCcVRpWTlERzZIbHhOYkN1emVzaFotbFdFSTgyUmxYaXhYTTdVYk9lYm9ldU9HSm8xUVQ3SGpOS1lWcmVmOXg0VTRaOWlmbW80NXFEeVBka2J6UmJtajJaUGloM1k1dUM0dWk5RjhKT3I5Vmo3VVVOU1NLb0c1R2hJVUJZRl81VFR6T3lFa0xER2dFVTJXUGU2enVFNUI1NFhDLTZfY1FWNUY3OUlRN1ZrYUVpMDl3VEJLeHp1SFQzdVh1UEl1cVJLVkdCNm1ZR2RtUlN5V3FOTE5Ddi1Db0JsaXBkU3c3YnlNMnU5b1N5OTZkbzItYXJycmFQc3dsanpDbTJhSlQ3eWUwcHRwZ0RHZkRQRGtHblRJR3Q2WHJyUVZOQ0FSWl9xOGJKV0RBUjBRLVlUcEM4SHpqVk1LQzdsSDItZlBjOXhHRUI0cXVxakdhdlJZb2ZSTTlEcF9kY01tOTJYempmVUFXSEJhWUI5bURrMUNpQVZpbGFvRlNMT2I1VWRJWUtNTUdBV2M4UnluSi1LSmdrRVgzZmZKU2ZERmRvZ0p1Y01pVzZha1V6S3o1eHJwbUhvUzRHcVpqTkVIYTVxbm9XQUxEc213aF91UjFRNFR5N1lORnB5bWpTWl85ZERXVlhiUjUySTFNMnNwV1cxTjJYVURUU0ZwRnFaUzRyZFhOSHV6TklVU3p0MkJ0d1NkTWlsU0FGXzZHZGJCM0pSOUhmaHpMZHo1VFFuUVE4OEdjVHB4WHIzZlFCRXM1V0FJNWx5MUtiQzd2b096c1F4LUhYOVkyTUNIZWhmX1ZqVWFWQXJyOEFuRDllQTQxR0N4ZWd0cnk1UWhyQVpRMnpHWjZpd0R0TlNOS0tlQ0g2V094WkZDUUxNWndiVEtrZDMzU1Q1WmptZFFVRFNidnphTHJIdjdibHl2WERxUzdFbmVfeTJpQndRVjJRVHhDcm9XdVk3eGNTV2ZlWnNjTWRBZnBlbTlUSl81VTQ5QktvT091bVcwMkFJZ3hIUXNXSlloZXlxLUloSmZNLW8zU0lVU3BTOGJQWVhqZkdKU1p5MWRCcWdaUlRRVlUyRE40VWwxMl81QVFUMGI5akJGZ3JpMVIxZDctSGVDaUktR2N1SVNPOF9xck5fWTEzLXpFR1d2MVpUX2REdy1TM3BfQzdoTnFIeUhrS19BLXVTX1lNUnc3bDczLTkzUmY1WjRmb1hRRVVKc1RHbi1vZC13cGxaeXJycFVJUTA4aDk3aFBOdjQ5dGJMV1lKSndGQTNvc0dUWGVHbkpNQXBsMXJoNDRWZEZ2VHFadDBCeWFneWhmZ1AxVUVPZV9Bc0NlTUF5V2lab2JLbnRqSGxOT2pKRmp6a09MLWVVMldGcTBUXy1iTWI3blNKOGtqS3I5aFFZcV96MXhlVkh4MzJRUXo5WkcyOHZVaFlHVEw0ZXp0M2g3Q0c5azZ3U01zUFRUYXhxc0NKel9DTzV5UGg1dEc2VWFHZkRYMGp6aWlLSkthOGRnSU9aaTZnV08zUlF5b3R6eXdQSUF2cUV6MUtTLWswSGdDczFsNTBBM0lyXzRNeGotSnNCa3U3Nk9qV3RHb1BzNEtiOEEyeXB3aWo3WlYyamhkejZOV0lKUm9BSDhvZ2pBbW15TU9qYW5ZZXhXLTlQTVJnT1pyUXpJdUFKWGY5V2lTSWlwM2FwRHppaXNjT3dpTHlJbGVMUzJCQlJxSU01VVF6SXhoVlRMM1o5TWhqZC16QnRFeEUzWmtRNmQ5TlVRU0xwRVE1LW9kU2tUbDhyamRaVk9tNm1jMGQ5NGtoYU9aX3BsZjJIeDFBdERLdm5OUFFtVHU2NE4zSTdsWEJLZlVaQmcwZkhtYkR1b2tZSWQ2VEJMOVRxblljZFh1a0h1OFNBTldEc1VqYUZvVHpLTU5mYXFJTTBmdUVnT0Q1ME1JRWE3c2NNR2xEalBGSjhIdVliaXVLWF9wc3VWOUhSd0Q1S09ZcDRZdjdkWjZzNENRV0psc2NRQ0JXMEVwMGtHLUdWR2JZU21RVlRvVkRqQkt1OHBrOFRSQTIwd1JDYzFkVDNyMENuVFlfWmtycVMwTURTeGtmRGlNYXR0MG9ZLWhhZTFMdDJCdDE0NnZqQk9tWW9LTEZsNGoyWTdsOUtiT0hJejEzcFVWYmpLYXk2WHZWeGNnYzBaU0tIR1VHQk5WZFNJTmhfdFZHc2JSd2JuVGtsaHV5TG9KczhKLWxkUkpKazhmSTB2OE40bGZkbEgweTlSQ20zUUdrRXk5MmVRVzVKOVlLUDNiU01saGMwWW5ZdFNseGZPYUh0a0o5Q1ZjbkVNRncyVVRrZlVoWGd4UU0yeFl2MzNpTjBySkNvRE1RRENzaVVkcWQzZDFlam11UjBXLUxiczF5Yk5kN2R4Z0RPdXVGRnh5NE5QSXFLVnQwQ0o4QXNpckN2UVFNM1pqNUJqcGVBU09UV0dYM09waHJiaHU1QTljRG1zcG5qU3NERngxOHB1S0xSc19DSDZPalNSOGNIcVprV2RaSnViQXdMV1VEQS51VmZtSGhqbHNtclgxb0ltcHVEeEln"
	dStr := "T2TNTXgC8iJ94qi1o5dtqie1_CMMw9iCdPumcXioEx0"
	xStr := "Rs2N56uYDcdPYRUzrCiTbVJ_mnF9UTRiqW8zMnsOHT0"
	yStr := "xEpxWgatdtSbt_8_t5RngJmMjqFX8OxSWX6rhCIF6a8"

	// "application/x-www-form-urlencoded"
	decoded, err := base64.StdEncoding.DecodeString(body)
	if err != nil {
		panic(err)
	}
	fmt.Println("##### Base64-decoded payload:")
	fmt.Println(string(decoded))

	values, err := url.ParseQuery(string(decoded))
	if err != nil {
		panic(err)
	}

	response := values.Get("response")
	fmt.Println("##### Decoded response (JWE?):")
	fmt.Println(response)

	privateKey := buildP256PrivateKeyFrom(dStr, xStr, yStr)
	decryptedPayload, err := openid4vp.DecryptJWE(response, privateKey)
	if err != nil {
		fmt.Printf("failed to decrypt JWE: %v", err)
	}

	ar := &openid4vp.AuthorizationResponse{}
	err = json.Unmarshal(decryptedPayload, ar)
	if err != nil {
		fmt.Printf("Failed to unmarshal: %v", err)
	}

	fmt.Printf("##### A_R: %v", ar)
}

func buildP256PrivateKeyFrom(dStr, xStr, yStr string) *ecdsa.PrivateKey {
	dBytes, err := base64.RawURLEncoding.DecodeString(dStr)
	if err != nil {
		panic(err)
	}
	xBytes, err := base64.RawURLEncoding.DecodeString(xStr)
	if err != nil {
		panic(err)
	}
	yBytes, err := base64.RawURLEncoding.DecodeString(yStr)
	if err != nil {
		panic(err)
	}

	d := new(big.Int).SetBytes(dBytes)
	x := new(big.Int).SetBytes(xBytes)
	y := new(big.Int).SetBytes(yBytes)

	privateKey := &ecdsa.PrivateKey{
		PublicKey: ecdsa.PublicKey{
			Curve: elliptic.P256(),
			X:     x,
			Y:     y,
		},
		D: d,
	}
	return privateKey
}
