package apiv1

import (
	"context"
	"fmt"
	"testing"
	"vc/pkg/logger"

	"github.com/stretchr/testify/assert"
)

func TestCreateCredential(t *testing.T) {
	ctx := context.TODO()

	log, err := logger.New("test", "", false)
	assert.NoError(t, err)

	client := mockNewClient(ctx, t, "ecdsa", log)

	var salt = "salt"

	t.Run("diploma", func(t *testing.T) {
		got, err := client.diplomaClient.sdjwt(ctx, mockDiploma, mockJWK, &salt)
		assert.NoError(t, err)

		//wantSDJWT := "eyJhbGciOiJFUzI1NiIsImtpZCI6ImRlZmF1bHRfc2lnbmluZ19rZXlfaWQiLCJ0eXAiOiJ2YytzZC1qd3QiLCJ2Y3RtIjoiZXlKMlkzUWlPaUpVWlhOMFEzSmxaR1Z1ZEdsaGJDSXNJbTVoYldVaU9pSlVaWE4wSUVOeVpXUmxiblJwWVd3aUxDSmtaWE5qY21sd2RHbHZiaUk2SWxSbGMzUWdRM0psWkdWdWRHbGhiQzRpTENKa2FYTndiR0Y1SWpwYmV5SnNZVzVuSWpvaVpXNHRWVk1pTENKdVlXMWxJam9pVkdWemRDQkRjbVZrWlc1MGFXRnNJaXdpWkdWelkzSnBjSFJwYjI0aU9pSlVaWE4wSUVOeVpXUmxiblJwWVd3dUlpd2ljbVZ1WkdWeWFXNW5JanA3SW5OcGJYQnNaU0k2ZXlKc2IyZHZJanA3SW5WeWFTSTZJaUlzSW5WeWFTTnBiblJsWjNKcGRIa2lPaUlpTENKaGJIUmZkR1Y0ZENJNklpSjlMQ0ppWVdOclozSnZkVzVrWDJOdmJHOXlJam9pSWl3aWRHVjRkRjlqYjJ4dmNpSTZJaUo5TENKemRtZGZkR1Z0Y0d4aGRHVnpJanBiZXlKMWNta2lPaUpvZEhSd2N6b3ZMM0poZHk1bmFYUm9kV0oxYzJWeVkyOXVkR1Z1ZEM1amIyMHZaR00wWlhVdmRtTXZOak16T1RRd1lqQmlNREJoWWpJMU9XRm1NREZqWm1KbVpqazFPR1l4Wm1abFltWTFNVGMyWVM5cGJXRm5aWE12Wkdsd2JHOXRZVlJsYlhCc1lYUmxMbk4yWnlJc0luVnlhU05wYm5SbFozSnBkSGtpT2lKemFHRXlOVFl0TVdGalpEUTRPRE00TWpaaFltRXdNekU0WkRJeE9USXhNMkppTnpWaE9XUm1ZemcxT0dZNU1qWmxPVE5tTlRjMk1qSTBOREV5TXpBeFptVXpNREU0WVNJc0luQnliM0JsY25ScFpYTWlPbnNpYjNKcFpXNTBZWFJwYjI0aU9pSWlMQ0pqYjJ4dmNsOXpZMmhsYldVaU9pSWlMQ0pqYjI1MGNtRnpkQ0k2SWlKOWZWMTlmVjBzSW1Oc1lXbHRjeUk2VzNzaWNHRjBhQ0k2V3lKd1pYSnpiMjVoYkY5aFpHMXBibWx6ZEhKaGRHbDJaVjl1ZFcxaVpYSWlYU3dpWkdsemNHeGhlU0k2VzNzaWJHRnVaeUk2SW1WdUxWVlRJaXdpYkdGaVpXd2lPaUpRWlhKemIyNWhiQ0JKUkNJc0ltUmxjMk55YVhCMGFXOXVJam9pVlc1cGNYVmxJSEJsY25OdmJtRnNJR2xrWlc1MGFXWnBaWElnZFhObFpDQmllU0J6YjJOcFlXd2djMlZqZFhKcGRIa2djMlZ5ZG1salpYTXVJbjFkTENKelpDSTZJbUZzZDJGNWN5SXNJbk4yWjE5cFpDSTZJbkJsY25OdmJtRnNYMkZrYldsdWFYTjBjbUYwYVhabFgyNTFiV0psY2w4MkluMHNleUp3WVhSb0lqcGJJbWx6YzNWcGJtZGZZWFYwYUc5eWFYUjVJbDBzSW1ScGMzQnNZWGtpT2x0N0lteGhibWNpT2lKbGJpMVZVeUlzSW14aFltVnNJam9pU1hOemRXbHVaeUJoZFhSb2IzSnBkSGtpZlYwc0luTmtJam9pYm1WMlpYSWlmVjBzSW5OamFHVnRZVjkxY213aU9pSWlMQ0p6WTJobGJXRmZkWEpzSTJsdWRHVm5jbWwwZVNJNklpSXNJbVY0ZEdWdVpITWlPaUlpTENKbGVIUmxibVJ6STJsdWRHVm5jbWwwZVNJNklpSjkifQ.eyJfc2RfYWxnIjoic2hhLTI1NiIsImNuZiI6eyJqd2siOnsia2lkIjoiZGVmYXVsdF9zaWduaW5nX2tleV9pZCIsImNydiI6IlAtMjU2Iiwia3R5IjoiRUMiLCJ4IjoiY3lWaUlFTm1xbzREMkNWT2MydUdaYmU1YThOaGVDeXZOOUNzRjd1aTN0ayIsInkiOiJYQTBsVlhnamdaekZURHdrbmRaRW8telZyOWllTzJyWTlIR2lpYWFBU29nIiwiZCI6Ik1ERXlNelExTmpjNE9UQXhNak0wTlRZM09Ea3dNVEl6TkRVMk56ZzVNREUifX0sImV4cCI6MTc3OTI3MTAyNywiaXNzIjoiaHR0cHM6Ly90ZXN0LWlzc3Vlci5zdW5ldC5zZSIsIm5iZiI6MTc0NzczNTAyNywidmN0IjoiRGlwbG9tYUNyZWRlbnRpYWwifQ.sV7UJ96gNR42ruU8FVF3QTXjVDAx_LryZGvnUzVdvm6wkKpwJsbB91J2c_Moio365fh8raJeCjm1IbIZ28-vtg~"

		assert.NotEmpty(t, got)
	})

	t.Run("pda1", func(t *testing.T) {

		got, err := client.pda1Client.sdjwt(ctx, mockPDA1, mockJWK, &salt)
		assert.NoError(t, err)

		fmt.Println("got", got)
		//wantSDJWT := "eyJhbGciOiJFUzI1NiIsImtpZCI6ImRlZmF1bHRfc2lnbmluZ19rZXlfaWQiLCJ0eXAiOiJ2YytzZC1qd3QiLCJ2Y3RtIjoiZXlKMlkzUWlPaUpVWlhOMFEzSmxaR1Z1ZEdsaGJDSXNJbTVoYldVaU9pSlVaWE4wSUVOeVpXUmxiblJwWVd3aUxDSmtaWE5qY21sd2RHbHZiaUk2SWxSbGMzUWdRM0psWkdWdWRHbGhiQzRpTENKa2FYTndiR0Y1SWpwYmV5SnNZVzVuSWpvaVpXNHRWVk1pTENKdVlXMWxJam9pVkdWemRDQkRjbVZrWlc1MGFXRnNJaXdpWkdWelkzSnBjSFJwYjI0aU9pSlVaWE4wSUVOeVpXUmxiblJwWVd3dUlpd2ljbVZ1WkdWeWFXNW5JanA3SW5OcGJYQnNaU0k2ZXlKc2IyZHZJanA3SW5WeWFTSTZJaUlzSW5WeWFTTnBiblJsWjNKcGRIa2lPaUlpTENKaGJIUmZkR1Y0ZENJNklpSjlMQ0ppWVdOclozSnZkVzVrWDJOdmJHOXlJam9pSWl3aWRHVjRkRjlqYjJ4dmNpSTZJaUo5TENKemRtZGZkR1Z0Y0d4aGRHVnpJanBiZXlKMWNta2lPaUpvZEhSd2N6b3ZMM0poZHk1bmFYUm9kV0oxYzJWeVkyOXVkR1Z1ZEM1amIyMHZaR00wWlhVdmRtTXZOak16T1RRd1lqQmlNREJoWWpJMU9XRm1NREZqWm1KbVpqazFPR1l4Wm1abFltWTFNVGMyWVM5cGJXRm5aWE12Wkdsd2JHOXRZVlJsYlhCc1lYUmxMbk4yWnlJc0luVnlhU05wYm5SbFozSnBkSGtpT2lKemFHRXlOVFl0TVdGalpEUTRPRE00TWpaaFltRXdNekU0WkRJeE9USXhNMkppTnpWaE9XUm1ZemcxT0dZNU1qWmxPVE5tTlRjMk1qSTBOREV5TXpBeFptVXpNREU0WVNJc0luQnliM0JsY25ScFpYTWlPbnNpYjNKcFpXNTBZWFJwYjI0aU9pSWlMQ0pqYjJ4dmNsOXpZMmhsYldVaU9pSWlMQ0pqYjI1MGNtRnpkQ0k2SWlKOWZWMTlmVjBzSW1Oc1lXbHRjeUk2VzNzaWNHRjBhQ0k2V3lKd1pYSnpiMjVoYkY5aFpHMXBibWx6ZEhKaGRHbDJaVjl1ZFcxaVpYSWlYU3dpWkdsemNHeGhlU0k2VzNzaWJHRnVaeUk2SW1WdUxWVlRJaXdpYkdGaVpXd2lPaUpRWlhKemIyNWhiQ0JKUkNJc0ltUmxjMk55YVhCMGFXOXVJam9pVlc1cGNYVmxJSEJsY25OdmJtRnNJR2xrWlc1MGFXWnBaWElnZFhObFpDQmllU0J6YjJOcFlXd2djMlZqZFhKcGRIa2djMlZ5ZG1salpYTXVJbjFkTENKelpDSTZJbUZzZDJGNWN5SXNJbk4yWjE5cFpDSTZJbkJsY25OdmJtRnNYMkZrYldsdWFYTjBjbUYwYVhabFgyNTFiV0psY2w4MkluMHNleUp3WVhSb0lqcGJJbWx6YzNWcGJtZGZZWFYwYUc5eWFYUjVJbDBzSW1ScGMzQnNZWGtpT2x0N0lteGhibWNpT2lKbGJpMVZVeUlzSW14aFltVnNJam9pU1hOemRXbHVaeUJoZFhSb2IzSnBkSGtpZlYwc0luTmtJam9pYm1WMlpYSWlmVjBzSW5OamFHVnRZVjkxY213aU9pSWlMQ0p6WTJobGJXRmZkWEpzSTJsdWRHVm5jbWwwZVNJNklpSXNJbVY0ZEdWdVpITWlPaUlpTENKbGVIUmxibVJ6STJsdWRHVm5jbWwwZVNJNklpSjkifQ.eyJfc2RfYWxnIjoic2hhLTI1NiIsImNuZiI6eyJqd2siOnsia2lkIjoiZGVmYXVsdF9zaWduaW5nX2tleV9pZCIsImNydiI6IlAtMjU2Iiwia3R5IjoiRUMiLCJ4IjoiY3lWaUlFTm1xbzREMkNWT2MydUdaYmU1YThOaGVDeXZOOUNzRjd1aTN0ayIsInkiOiJYQTBsVlhnamdaekZURHdrbmRaRW8telZyOWllTzJyWTlIR2lpYWFBU29nIiwiZCI6Ik1ERXlNelExTmpjNE9UQXhNak0wTlRZM09Ea3dNVEl6TkRVMk56ZzVNREUifX0sImV4cCI6MTc3OTI3MTAyNywiaXNzIjoiaHR0cHM6Ly90ZXN0LWlzc3Vlci5zdW5ldC5zZSIsIm5iZiI6MTc0NzczNTAyNywidmN0IjoiRGlwbG9tYUNyZWRlbnRpYWwifQ.sV7UJ96gNR42ruU8FVF3QTXjVDAx_LryZGvnUzVdvm6wkKpwJsbB91J2c_Moio365fh8raJeCjm1IbIZ28-vtg~"

		assert.NotEmpty(t, got)
	})

	t.Run("pid", func(t *testing.T) {
		want, err := client.pidClient.sdjwt(ctx, mockPID, mockJWK, &salt)
		assert.NoError(t, err)

		//wantSDJWT := "eyJhbGciOiJFUzI1NiIsImtpZCI6ImRlZmF1bHRfc2lnbmluZ19rZXlfaWQiLCJ0eXAiOiJ2YytzZC1qd3QiLCJ2Y3RtIjoiZXlKMlkzUWlPaUpVWlhOMFEzSmxaR1Z1ZEdsaGJDSXNJbTVoYldVaU9pSlVaWE4wSUVOeVpXUmxiblJwWVd3aUxDSmtaWE5qY21sd2RHbHZiaUk2SWxSbGMzUWdRM0psWkdWdWRHbGhiQzRpTENKa2FYTndiR0Y1SWpwYmV5SnNZVzVuSWpvaVpXNHRWVk1pTENKdVlXMWxJam9pVkdWemRDQkRjbVZrWlc1MGFXRnNJaXdpWkdWelkzSnBjSFJwYjI0aU9pSlVaWE4wSUVOeVpXUmxiblJwWVd3dUlpd2ljbVZ1WkdWeWFXNW5JanA3SW5OcGJYQnNaU0k2ZXlKc2IyZHZJanA3SW5WeWFTSTZJaUlzSW5WeWFTTnBiblJsWjNKcGRIa2lPaUlpTENKaGJIUmZkR1Y0ZENJNklpSjlMQ0ppWVdOclozSnZkVzVrWDJOdmJHOXlJam9pSWl3aWRHVjRkRjlqYjJ4dmNpSTZJaUo5TENKemRtZGZkR1Z0Y0d4aGRHVnpJanBiZXlKMWNta2lPaUpvZEhSd2N6b3ZMM0poZHk1bmFYUm9kV0oxYzJWeVkyOXVkR1Z1ZEM1amIyMHZaR00wWlhVdmRtTXZOak16T1RRd1lqQmlNREJoWWpJMU9XRm1NREZqWm1KbVpqazFPR1l4Wm1abFltWTFNVGMyWVM5cGJXRm5aWE12Wkdsd2JHOXRZVlJsYlhCc1lYUmxMbk4yWnlJc0luVnlhU05wYm5SbFozSnBkSGtpT2lKemFHRXlOVFl0TVdGalpEUTRPRE00TWpaaFltRXdNekU0WkRJeE9USXhNMkppTnpWaE9XUm1ZemcxT0dZNU1qWmxPVE5tTlRjMk1qSTBOREV5TXpBeFptVXpNREU0WVNJc0luQnliM0JsY25ScFpYTWlPbnNpYjNKcFpXNTBZWFJwYjI0aU9pSWlMQ0pqYjJ4dmNsOXpZMmhsYldVaU9pSWlMQ0pqYjI1MGNtRnpkQ0k2SWlKOWZWMTlmVjBzSW1Oc1lXbHRjeUk2VzNzaWNHRjBhQ0k2V3lKd1pYSnpiMjVoYkY5aFpHMXBibWx6ZEhKaGRHbDJaVjl1ZFcxaVpYSWlYU3dpWkdsemNHeGhlU0k2VzNzaWJHRnVaeUk2SW1WdUxWVlRJaXdpYkdGaVpXd2lPaUpRWlhKemIyNWhiQ0JKUkNJc0ltUmxjMk55YVhCMGFXOXVJam9pVlc1cGNYVmxJSEJsY25OdmJtRnNJR2xrWlc1MGFXWnBaWElnZFhObFpDQmllU0J6YjJOcFlXd2djMlZqZFhKcGRIa2djMlZ5ZG1salpYTXVJbjFkTENKelpDSTZJbUZzZDJGNWN5SXNJbk4yWjE5cFpDSTZJbkJsY25OdmJtRnNYMkZrYldsdWFYTjBjbUYwYVhabFgyNTFiV0psY2w4MkluMHNleUp3WVhSb0lqcGJJbWx6YzNWcGJtZGZZWFYwYUc5eWFYUjVJbDBzSW1ScGMzQnNZWGtpT2x0N0lteGhibWNpT2lKbGJpMVZVeUlzSW14aFltVnNJam9pU1hOemRXbHVaeUJoZFhSb2IzSnBkSGtpZlYwc0luTmtJam9pYm1WMlpYSWlmVjBzSW5OamFHVnRZVjkxY213aU9pSWlMQ0p6WTJobGJXRmZkWEpzSTJsdWRHVm5jbWwwZVNJNklpSXNJbVY0ZEdWdVpITWlPaUlpTENKbGVIUmxibVJ6STJsdWRHVm5jbWwwZVNJNklpSjkifQ.eyJfc2RfYWxnIjoic2hhLTI1NiIsImNuZiI6eyJqd2siOnsia2lkIjoiZGVmYXVsdF9zaWduaW5nX2tleV9pZCIsImNydiI6IlAtMjU2Iiwia3R5IjoiRUMiLCJ4IjoiY3lWaUlFTm1xbzREMkNWT2MydUdaYmU1YThOaGVDeXZOOUNzRjd1aTN0ayIsInkiOiJYQTBsVlhnamdaekZURHdrbmRaRW8telZyOWllTzJyWTlIR2lpYWFBU29nIiwiZCI6Ik1ERXlNelExTmpjNE9UQXhNak0wTlRZM09Ea3dNVEl6TkRVMk56ZzVNREUifX0sImV4cCI6MTc3OTI3MTAyNywiaXNzIjoiaHR0cHM6Ly90ZXN0LWlzc3Vlci5zdW5ldC5zZSIsIm5iZiI6MTc0NzczNTAyNywidmN0IjoiRGlwbG9tYUNyZWRlbnRpYWwifQ.sV7UJ96gNR42ruU8FVF3QTXjVDAx_LryZGvnUzVdvm6wkKpwJsbB91J2c_Moio365fh8raJeCjm1IbIZ28-vtg~"

		assert.NotEmpty(t, want)
	})

	t.Run("ehic", func(t *testing.T) {
		want, err := client.ehicClient.sdjwt(ctx, mockEHIC, mockJWK, &salt)
		assert.NoError(t, err)

		//wantSDJWT := "eyJhbGciOiJFUzI1NiIsImtpZCI6ImRlZmF1bHRfc2lnbmluZ19rZXlfaWQiLCJ0eXAiOiJ2YytzZC1qd3QiLCJ2Y3RtIjoiZXlKMlkzUWlPaUpVWlhOMFEzSmxaR1Z1ZEdsaGJDSXNJbTVoYldVaU9pSlVaWE4wSUVOeVpXUmxiblJwWVd3aUxDSmtaWE5qY21sd2RHbHZiaUk2SWxSbGMzUWdRM0psWkdWdWRHbGhiQzRpTENKa2FYTndiR0Y1SWpwYmV5SnNZVzVuSWpvaVpXNHRWVk1pTENKdVlXMWxJam9pVkdWemRDQkRjbVZrWlc1MGFXRnNJaXdpWkdWelkzSnBjSFJwYjI0aU9pSlVaWE4wSUVOeVpXUmxiblJwWVd3dUlpd2ljbVZ1WkdWeWFXNW5JanA3SW5OcGJYQnNaU0k2ZXlKc2IyZHZJanA3SW5WeWFTSTZJaUlzSW5WeWFTTnBiblJsWjNKcGRIa2lPaUlpTENKaGJIUmZkR1Y0ZENJNklpSjlMQ0ppWVdOclozSnZkVzVrWDJOdmJHOXlJam9pSWl3aWRHVjRkRjlqYjJ4dmNpSTZJaUo5TENKemRtZGZkR1Z0Y0d4aGRHVnpJanBiZXlKMWNta2lPaUpvZEhSd2N6b3ZMM0poZHk1bmFYUm9kV0oxYzJWeVkyOXVkR1Z1ZEM1amIyMHZaR00wWlhVdmRtTXZOak16T1RRd1lqQmlNREJoWWpJMU9XRm1NREZqWm1KbVpqazFPR1l4Wm1abFltWTFNVGMyWVM5cGJXRm5aWE12Wkdsd2JHOXRZVlJsYlhCc1lYUmxMbk4yWnlJc0luVnlhU05wYm5SbFozSnBkSGtpT2lKemFHRXlOVFl0TVdGalpEUTRPRE00TWpaaFltRXdNekU0WkRJeE9USXhNMkppTnpWaE9XUm1ZemcxT0dZNU1qWmxPVE5tTlRjMk1qSTBOREV5TXpBeFptVXpNREU0WVNJc0luQnliM0JsY25ScFpYTWlPbnNpYjNKcFpXNTBZWFJwYjI0aU9pSWlMQ0pqYjJ4dmNsOXpZMmhsYldVaU9pSWlMQ0pqYjI1MGNtRnpkQ0k2SWlKOWZWMTlmVjBzSW1Oc1lXbHRjeUk2VzNzaWNHRjBhQ0k2V3lKd1pYSnpiMjVoYkY5aFpHMXBibWx6ZEhKaGRHbDJaVjl1ZFcxaVpYSWlYU3dpWkdsemNHeGhlU0k2VzNzaWJHRnVaeUk2SW1WdUxWVlRJaXdpYkdGaVpXd2lPaUpRWlhKemIyNWhiQ0JKUkNJc0ltUmxjMk55YVhCMGFXOXVJam9pVlc1cGNYVmxJSEJsY25OdmJtRnNJR2xrWlc1MGFXWnBaWElnZFhObFpDQmllU0J6YjJOcFlXd2djMlZqZFhKcGRIa2djMlZ5ZG1salpYTXVJbjFkTENKelpDSTZJbUZzZDJGNWN5SXNJbk4yWjE5cFpDSTZJbkJsY25OdmJtRnNYMkZrYldsdWFYTjBjbUYwYVhabFgyNTFiV0psY2w4MkluMHNleUp3WVhSb0lqcGJJbWx6YzNWcGJtZGZZWFYwYUc5eWFYUjVJbDBzSW1ScGMzQnNZWGtpT2x0N0lteGhibWNpT2lKbGJpMVZVeUlzSW14aFltVnNJam9pU1hOemRXbHVaeUJoZFhSb2IzSnBkSGtpZlYwc0luTmtJam9pYm1WMlpYSWlmVjBzSW5OamFHVnRZVjkxY213aU9pSWlMQ0p6WTJobGJXRmZkWEpzSTJsdWRHVm5jbWwwZVNJNklpSXNJbVY0ZEdWdVpITWlPaUlpTENKbGVIUmxibVJ6STJsdWRHVm5jbWwwZVNJNklpSjkifQ.eyJfc2RfYWxnIjoic2hhLTI1NiIsImNuZiI6eyJqd2siOnsia2lkIjoiZGVmYXVsdF9zaWduaW5nX2tleV9pZCIsImNydiI6IlAtMjU2Iiwia3R5IjoiRUMiLCJ4IjoiY3lWaUlFTm1xbzREMkNWT2MydUdaYmU1YThOaGVDeXZOOUNzRjd1aTN0ayIsInkiOiJYQTBsVlhnamdaekZURHdrbmRaRW8telZyOWllTzJyWTlIR2lpYWFBU29nIiwiZCI6Ik1ERXlNelExTmpjNE9UQXhNak0wTlRZM09Ea3dNVEl6TkRVMk56ZzVNREUifX0sImV4cCI6MTc3OTI3MTAyNywiaXNzIjoiaHR0cHM6Ly90ZXN0LWlzc3Vlci5zdW5ldC5zZSIsIm5iZiI6MTc0NzczNTAyNywidmN0IjoiRGlwbG9tYUNyZWRlbnRpYWwifQ.sV7UJ96gNR42ruU8FVF3QTXjVDAx_LryZGvnUzVdvm6wkKpwJsbB91J2c_Moio365fh8raJeCjm1IbIZ28-vtg~"

		assert.NotEmpty(t, want)
	})

	t.Run("elm", func(t *testing.T) {
		want, err := client.elmClient.sdjwt(ctx, mockELM, mockJWK, &salt)
		assert.NoError(t, err)

		//wantSDJWT := "eyJhbGciOiJFUzI1NiIsImtpZCI6ImRlZmF1bHRfc2lnbmluZ19rZXlfaWQiLCJ0eXAiOiJ2YytzZC1qd3QiLCJ2Y3RtIjoiZXlKMlkzUWlPaUpVWlhOMFEzSmxaR1Z1ZEdsaGJDSXNJbTVoYldVaU9pSlVaWE4wSUVOeVpXUmxiblJwWVd3aUxDSmtaWE5qY21sd2RHbHZiaUk2SWxSbGMzUWdRM0psWkdWdWRHbGhiQzRpTENKa2FYTndiR0Y1SWpwYmV5SnNZVzVuSWpvaVpXNHRWVk1pTENKdVlXMWxJam9pVkdWemRDQkRjbVZrWlc1MGFXRnNJaXdpWkdWelkzSnBjSFJwYjI0aU9pSlVaWE4wSUVOeVpXUmxiblJwWVd3dUlpd2ljbVZ1WkdWeWFXNW5JanA3SW5OcGJYQnNaU0k2ZXlKc2IyZHZJanA3SW5WeWFTSTZJaUlzSW5WeWFTTnBiblJsWjNKcGRIa2lPaUlpTENKaGJIUmZkR1Y0ZENJNklpSjlMQ0ppWVdOclozSnZkVzVrWDJOdmJHOXlJam9pSWl3aWRHVjRkRjlqYjJ4dmNpSTZJaUo5TENKemRtZGZkR1Z0Y0d4aGRHVnpJanBiZXlKMWNta2lPaUpvZEhSd2N6b3ZMM0poZHk1bmFYUm9kV0oxYzJWeVkyOXVkR1Z1ZEM1amIyMHZaR00wWlhVdmRtTXZOak16T1RRd1lqQmlNREJoWWpJMU9XRm1NREZqWm1KbVpqazFPR1l4Wm1abFltWTFNVGMyWVM5cGJXRm5aWE12Wkdsd2JHOXRZVlJsYlhCc1lYUmxMbk4yWnlJc0luVnlhU05wYm5SbFozSnBkSGtpT2lKemFHRXlOVFl0TVdGalpEUTRPRE00TWpaaFltRXdNekU0WkRJeE9USXhNMkppTnpWaE9XUm1ZemcxT0dZNU1qWmxPVE5tTlRjMk1qSTBOREV5TXpBeFptVXpNREU0WVNJc0luQnliM0JsY25ScFpYTWlPbnNpYjNKcFpXNTBZWFJwYjI0aU9pSWlMQ0pqYjJ4dmNsOXpZMmhsYldVaU9pSWlMQ0pqYjI1MGNtRnpkQ0k2SWlKOWZWMTlmVjBzSW1Oc1lXbHRjeUk2VzNzaWNHRjBhQ0k2V3lKd1pYSnpiMjVoYkY5aFpHMXBibWx6ZEhKaGRHbDJaVjl1ZFcxaVpYSWlYU3dpWkdsemNHeGhlU0k2VzNzaWJHRnVaeUk2SW1WdUxWVlRJaXdpYkdGaVpXd2lPaUpRWlhKemIyNWhiQ0JKUkNJc0ltUmxjMk55YVhCMGFXOXVJam9pVlc1cGNYVmxJSEJsY25OdmJtRnNJR2xrWlc1MGFXWnBaWElnZFhObFpDQmllU0J6YjJOcFlXd2djMlZqZFhKcGRIa2djMlZ5ZG1salpYTXVJbjFkTENKelpDSTZJbUZzZDJGNWN5SXNJbk4yWjE5cFpDSTZJbkJsY25OdmJtRnNYMkZrYldsdWFYTjBjbUYwYVhabFgyNTFiV0psY2w4MkluMHNleUp3WVhSb0lqcGJJbWx6YzNWcGJtZGZZWFYwYUc5eWFYUjVJbDBzSW1ScGMzQnNZWGtpT2x0N0lteGhibWNpT2lKbGJpMVZVeUlzSW14aFltVnNJam9pU1hOemRXbHVaeUJoZFhSb2IzSnBkSGtpZlYwc0luTmtJam9pYm1WMlpYSWlmVjBzSW5OamFHVnRZVjkxY213aU9pSWlMQ0p6WTJobGJXRmZkWEpzSTJsdWRHVm5jbWwwZVNJNklpSXNJbVY0ZEdWdVpITWlPaUlpTENKbGVIUmxibVJ6STJsdWRHVm5jbWwwZVNJNklpSjkifQ.eyJfc2RfYWxnIjoic2hhLTI1NiIsImNuZiI6eyJqd2siOnsia2lkIjoiZGVmYXVsdF9zaWduaW5nX2tleV9pZCIsImNydiI6IlAtMjU2Iiwia3R5IjoiRUMiLCJ4IjoiY3lWaUlFTm1xbzREMkNWT2MydUdaYmU1YThOaGVDeXZOOUNzRjd1aTN0ayIsInkiOiJYQTBsVlhnamdaekZURHdrbmRaRW8telZyOWllTzJyWTlIR2lpYWFBU29nIiwiZCI6Ik1ERXlNelExTmpjNE9UQXhNak0wTlRZM09Ea3dNVEl6TkRVMk56ZzVNREUifX0sImV4cCI6MTc3OTI3MTAyNywiaXNzIjoiaHR0cHM6Ly90ZXN0LWlzc3Vlci5zdW5ldC5zZSIsIm5iZiI6MTc0NzczNTAyNywidmN0IjoiRGlwbG9tYUNyZWRlbnRpYWwifQ.sV7UJ96gNR42ruU8FVF3QTXjVDAx_LryZGvnUzVdvm6wkKpwJsbB91J2c_Moio365fh8raJeCjm1IbIZ28-vtg~"

		assert.NotEmpty(t, want)
	})

	t.Run("micro_credential", func(t *testing.T) {
		want, err := client.microCredentialClient.sdjwt(ctx, mockMicroCredential, mockJWK, &salt)
		assert.NoError(t, err)

		//wantSDJWT := "eyJhbGciOiJFUzI1NiIsImtpZCI6ImRlZmF1bHRfc2lnbmluZ19rZXlfaWQiLCJ0eXAiOiJ2YytzZC1qd3QiLCJ2Y3RtIjoiZXlKMlkzUWlPaUpVWlhOMFEzSmxaR1Z1ZEdsaGJDSXNJbTVoYldVaU9pSlVaWE4wSUVOeVpXUmxiblJwWVd3aUxDSmtaWE5qY21sd2RHbHZiaUk2SWxSbGMzUWdRM0psWkdWdWRHbGhiQzRpTENKa2FYTndiR0Y1SWpwYmV5SnNZVzVuSWpvaVpXNHRWVk1pTENKdVlXMWxJam9pVkdWemRDQkRjbVZrWlc1MGFXRnNJaXdpWkdWelkzSnBjSFJwYjI0aU9pSlVaWE4wSUVOeVpXUmxiblJwWVd3dUlpd2ljbVZ1WkdWeWFXNW5JanA3SW5OcGJYQnNaU0k2ZXlKc2IyZHZJanA3SW5WeWFTSTZJaUlzSW5WeWFTTnBiblJsWjNKcGRIa2lPaUlpTENKaGJIUmZkR1Y0ZENJNklpSjlMQ0ppWVdOclozSnZkVzVrWDJOdmJHOXlJam9pSWl3aWRHVjRkRjlqYjJ4dmNpSTZJaUo5TENKemRtZGZkR1Z0Y0d4aGRHVnpJanBiZXlKMWNta2lPaUpvZEhSd2N6b3ZMM0poZHk1bmFYUm9kV0oxYzJWeVkyOXVkR1Z1ZEM1amIyMHZaR00wWlhVdmRtTXZOak16T1RRd1lqQmlNREJoWWpJMU9XRm1NREZqWm1KbVpqazFPR1l4Wm1abFltWTFNVGMyWVM5cGJXRm5aWE12Wkdsd2JHOXRZVlJsYlhCc1lYUmxMbk4yWnlJc0luVnlhU05wYm5SbFozSnBkSGtpT2lKemFHRXlOVFl0TVdGalpEUTRPRE00TWpaaFltRXdNekU0WkRJeE9USXhNMkppTnpWaE9XUm1ZemcxT0dZNU1qWmxPVE5tTlRjMk1qSTBOREV5TXpBeFptVXpNREU0WVNJc0luQnliM0JsY25ScFpYTWlPbnNpYjNKcFpXNTBZWFJwYjI0aU9pSWlMQ0pqYjJ4dmNsOXpZMmhsYldVaU9pSWlMQ0pqYjI1MGNtRnpkQ0k2SWlKOWZWMTlmVjBzSW1Oc1lXbHRjeUk2VzNzaWNHRjBhQ0k2V3lKd1pYSnpiMjVoYkY5aFpHMXBibWx6ZEhKaGRHbDJaVjl1ZFcxaVpYSWlYU3dpWkdsemNHeGhlU0k2VzNzaWJHRnVaeUk2SW1WdUxWVlRJaXdpYkdGaVpXd2lPaUpRWlhKemIyNWhiQ0JKUkNJc0ltUmxjMk55YVhCMGFXOXVJam9pVlc1cGNYVmxJSEJsY25OdmJtRnNJR2xrWlc1MGFXWnBaWElnZFhObFpDQmllU0J6YjJOcFlXd2djMlZqZFhKcGRIa2djMlZ5ZG1salpYTXVJbjFkTENKelpDSTZJbUZzZDJGNWN5SXNJbk4yWjE5cFpDSTZJbkJsY25OdmJtRnNYMkZrYldsdWFYTjBjbUYwYVhabFgyNTFiV0psY2w4MkluMHNleUp3WVhSb0lqcGJJbWx6YzNWcGJtZGZZWFYwYUc5eWFYUjVJbDBzSW1ScGMzQnNZWGtpT2x0N0lteGhibWNpT2lKbGJpMVZVeUlzSW14aFltVnNJam9pU1hOemRXbHVaeUJoZFhSb2IzSnBkSGtpZlYwc0luTmtJam9pYm1WMlpYSWlmVjBzSW5OamFHVnRZVjkxY213aU9pSWlMQ0p6WTJobGJXRmZkWEpzSTJsdWRHVm5jbWwwZVNJNklpSXNJbVY0ZEdWdVpITWlPaUlpTENKbGVIUmxibVJ6STJsdWRHVm5jbWwwZVNJNklpSjkifQ.eyJfc2RfYWxnIjoic2hhLTI1NiIsImNuZiI6eyJqd2siOnsia2lkIjoiZGVmYXVsdF9zaWduaW5nX2tleV9pZCIsImNydiI6IlAtMjU2Iiwia3R5IjoiRUMiLCJ4IjoiY3lWaUlFTm1xbzREMkNWT2MydUdaYmU1YThOaGVDeXZOOUNzRjd1aTN0ayIsInkiOiJYQTBsVlhnamdaekZURHdrbmRaRW8telZyOWllTzJyWTlIR2lpYWFBU29nIiwiZCI6Ik1ERXlNelExTmpjNE9UQXhNak0wTlRZM09Ea3dNVEl6TkRVMk56ZzVNREUifX0sImV4cCI6MTc3OTI3MTAyNywiaXNzIjoiaHR0cHM6Ly90ZXN0LWlzc3Vlci5zdW5ldC5zZSIsIm5iZiI6MTc0NzczNTAyNywidmN0IjoiRGlwbG9tYUNyZWRlbnRpYWwifQ.sV7UJ96gNR42ruU8FVF3QTXjVDAx_LryZGvnUzVdvm6wkKpwJsbB91J2c_Moio365fh8raJeCjm1IbIZ28-vtg~"

		assert.NotEmpty(t, want)
	})
}
